# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

## –û–±–∑–æ—Ä

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã:
- **–§–∏–Ω–∞–Ω—Å—ã** (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π, –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π)
- **–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏** (–∑–∞–≥–ª—É—à–∫–∞, –±—É–¥—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
- **–õ–∏—á–Ω—ã–µ** (–∑–∞–≥–ª—É—à–∫–∞, –±—É–¥—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
- **–£—á—ë—Ç —Ç–µ–Ω–¥–µ—Ä–æ–≤** (–∑–∞–≥–ª—É—à–∫–∞, –±—É–¥—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)

## –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –ö–∞–∂–¥—ã–π —Ä–µ–∂–∏–º ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å
- –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ shared
- Feature flags –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### 2. Multi-tenancy
- –°—Ç—Ä–æ–≥–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ `org_id`
- Row Level Security (RLS) –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–æ–ª—è—Ü–∏–∏

### 3. –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ UI
- –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å (header)
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ª–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (sidebar) –ø–æ —Ä–µ–∂–∏–º—É
- –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

### 4. –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
- Mode Registry –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Ä–µ–∂–∏–º–æ–≤
- Plugin-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- API-first –ø–æ–¥—Ö–æ–¥

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤

```
app/
‚îú‚îÄ‚îÄ (platform)/                    # –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx                # –û—Å–Ω–æ–≤–Ω–æ–π layout —Å header
‚îÇ   ‚îú‚îÄ‚îÄ PlatformShell.tsx         # Shell —Å mode switcher
‚îÇ   ‚îú‚îÄ‚îÄ mode-registry.ts          # –†–µ–µ—Å—Ç—Ä —Ä–µ–∂–∏–º–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ finance/                  # –†–µ–∂–∏–º: –§–∏–Ω–∞–Ω—Å—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx            # Layout —Ä–µ–∂–∏–º–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sidebar.tsx           # –õ–µ–≤–æ–µ –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ transactions/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ budgets/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...                   # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ investments/              # –†–µ–∂–∏–º: –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sidebar.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ placeholder/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ personal/                 # –†–µ–∂–∏–º: –õ–∏—á–Ω—ã–µ (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sidebar.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ placeholder/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ tenders/                  # –†–µ–∂–∏–º: –¢–µ–Ω–¥–µ—Ä—ã (–∑–∞–≥–ª—É—à–∫–∞)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sidebar.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ placeholder/
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ settings/                 # –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ organization/
‚îÇ       ‚îú‚îÄ‚îÄ users/
‚îÇ       ‚îú‚îÄ‚îÄ roles/
‚îÇ       ‚îú‚îÄ‚îÄ integrations/
‚îÇ       ‚îú‚îÄ‚îÄ categories/
‚îÇ       ‚îî‚îÄ‚îÄ billing/
‚îÇ
components/
‚îú‚îÄ‚îÄ platform/                     # –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx               # –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ ModeSwitcher.tsx         # –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ OrgSwitcher.tsx          # –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ NotificationCenter.tsx   # –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ UserMenu.tsx             # –ú–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ
‚îú‚îÄ‚îÄ shared/                       # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ navigation/
‚îÇ   ‚îú‚îÄ‚îÄ forms/
‚îÇ   ‚îî‚îÄ‚îÄ data-display/
‚îÇ
‚îî‚îÄ‚îÄ modes/                        # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∂–∏–º–æ–≤
    ‚îú‚îÄ‚îÄ finance/
    ‚îú‚îÄ‚îÄ investments/
    ‚îú‚îÄ‚îÄ personal/
    ‚îî‚îÄ‚îÄ tenders/

lib/
‚îú‚îÄ‚îÄ platform/
‚îÇ   ‚îú‚îÄ‚îÄ modes.ts                 # Mode Registry API
‚îÇ   ‚îú‚îÄ‚îÄ permissions.ts           # –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤
‚îÇ   ‚îî‚îÄ‚îÄ multi-tenant.ts          # Multi-tenancy helpers
‚îÇ
‚îî‚îÄ‚îÄ integrations/                # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
    ‚îú‚îÄ‚îÄ telegram/
    ‚îú‚îÄ‚îÄ n8n/
    ‚îî‚îÄ‚îÄ registry.ts

db/
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ 001_add_orgs.sql         # –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ 002_add_modes.sql        # –†–µ–∂–∏–º—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ 003_migrate_finance.sql  # –ú–∏–≥—Ä–∞—Ü–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤
‚îÇ
‚îî‚îÄ‚îÄ rls/                          # RLS –ø–æ–ª–∏—Ç–∏–∫–∏
    ‚îú‚îÄ‚îÄ organizations.sql
    ‚îú‚îÄ‚îÄ users.sql
    ‚îî‚îÄ‚îÄ mode_data.sql
```

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

```sql
-- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (multi-tenancy)
CREATE TABLE organizations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  slug TEXT UNIQUE NOT NULL,
  owner_id UUID REFERENCES auth.users(id),
  settings JSONB DEFAULT '{}',
  subscription_plan TEXT DEFAULT 'free',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ß–ª–µ–Ω—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
CREATE TABLE organization_members (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID REFERENCES organizations(id) ON DELETE CASCADE,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  role TEXT NOT NULL DEFAULT 'member',
  permissions JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(org_id, user_id)
);

-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–∂–∏–º–æ–≤ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
CREATE TABLE organization_mode_settings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID REFERENCES organizations(id) ON DELETE CASCADE,
  mode_key TEXT NOT NULL, -- 'finance', 'investments', etc.
  is_enabled BOOLEAN DEFAULT TRUE,
  settings JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(org_id, mode_key)
);

-- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
CREATE TABLE organization_integrations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  org_id UUID REFERENCES organizations(id) ON DELETE CASCADE,
  integration_type TEXT NOT NULL, -- 'telegram', 'n8n', etc.
  is_active BOOLEAN DEFAULT FALSE,
  config JSONB DEFAULT '{}',
  credentials JSONB DEFAULT '{}', -- encrypted
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(org_id, integration_type)
);
```

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü

–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—É—á–∞—é—Ç –ø–æ–ª–µ `org_id`:

```sql
-- –î–æ–±–∞–≤–ª—è–µ–º org_id –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–∞–±–ª–∏—Ü–∞–º
ALTER TABLE transactions ADD COLUMN org_id UUID REFERENCES organizations(id);
ALTER TABLE accounts ADD COLUMN org_id UUID REFERENCES organizations(id);
ALTER TABLE categories ADD COLUMN org_id UUID REFERENCES organizations(id);
ALTER TABLE budgets ADD COLUMN org_id UUID REFERENCES organizations(id);
-- ... –∏ —Ç.–¥. –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü

-- –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö: —Å–æ–∑–¥–∞—ë–º –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
INSERT INTO organizations (name, slug, owner_id)
SELECT 
  '–õ–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è ' || id,
  'org-' || id,
  id
FROM auth.users;

-- –°–≤—è–∑—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏
UPDATE transactions t
SET org_id = (
  SELECT id FROM organizations WHERE owner_id = t.user_id LIMIT 1
);
```

## Mode Registry

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —Ä–µ–∂–∏–º–æ–≤:

```typescript
// lib/platform/mode-registry.ts
export interface ModeConfig {
  key: string;
  name: string;
  icon: string;
  color: string;
  description: string;
  isEnabled: boolean;
  permissions: {
    view: string[];
    edit: string[];
    admin: string[];
  };
  routes: {
    root: string;
    dashboard: string;
  };
  features: {
    ai: boolean;
    analytics: boolean;
    exports: boolean;
    integrations: boolean;
  };
}

export const MODE_REGISTRY: Record<string, ModeConfig> = {
  finance: {
    key: 'finance',
    name: '–§–∏–Ω–∞–Ω—Å—ã',
    icon: 'account_balance_wallet',
    color: '#10B981',
    description: '–£—á—ë—Ç –¥–æ—Ö–æ–¥–æ–≤, —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏ –±—é–¥–∂–µ—Ç–æ–≤',
    isEnabled: true,
    permissions: {
      view: ['member', 'admin', 'owner'],
      edit: ['admin', 'owner'],
      admin: ['owner'],
    },
    routes: {
      root: '/finance',
      dashboard: '/finance/dashboard',
    },
    features: {
      ai: true,
      analytics: true,
      exports: true,
      integrations: true,
    },
  },
  investments: {
    key: 'investments',
    name: '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',
    icon: 'trending_up',
    color: '#3B82F6',
    description: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º–∏',
    isEnabled: false, // Feature flag
    permissions: {
      view: ['member', 'admin', 'owner'],
      edit: ['admin', 'owner'],
      admin: ['owner'],
    },
    routes: {
      root: '/investments',
      dashboard: '/investments/dashboard',
    },
    features: {
      ai: true,
      analytics: true,
      exports: true,
      integrations: false,
    },
  },
  personal: {
    key: 'personal',
    name: '–õ–∏—á–Ω—ã–µ',
    icon: 'person',
    color: '#8B5CF6',
    description: '–õ–∏—á–Ω—ã–π –æ—Ä–≥–∞–Ω–∞–π–∑–µ—Ä –∏ –∑–∞–º–µ—Ç–∫–∏',
    isEnabled: false,
    permissions: {
      view: ['member', 'admin', 'owner'],
      edit: ['member', 'admin', 'owner'],
      admin: ['owner'],
    },
    routes: {
      root: '/personal',
      dashboard: '/personal/dashboard',
    },
    features: {
      ai: true,
      analytics: false,
      exports: true,
      integrations: false,
    },
  },
  tenders: {
    key: 'tenders',
    name: '–¢–µ–Ω–¥–µ—Ä—ã',
    icon: 'description',
    color: '#F59E0B',
    description: '–£—á—ë—Ç –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–Ω–¥–µ—Ä–∞–º–∏',
    isEnabled: false,
    permissions: {
      view: ['member', 'admin', 'owner'],
      edit: ['admin', 'owner'],
      admin: ['owner'],
    },
    routes: {
      root: '/tenders',
      dashboard: '/tenders/dashboard',
    },
    features: {
      ai: true,
      analytics: true,
      exports: true,
      integrations: true,
    },
  },
};
```

## –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –∏ —Ä–æ–ª–µ–π

```typescript
// lib/platform/permissions.ts
export enum Role {
  OWNER = 'owner',     // –í–ª–∞–¥–µ–ª–µ—Ü –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
  ADMIN = 'admin',     // –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
  MEMBER = 'member',   // –£—á–∞—Å—Ç–Ω–∏–∫
  VIEWER = 'viewer',   // –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä
}

export interface Permission {
  mode: string;
  action: 'view' | 'create' | 'edit' | 'delete' | 'admin';
  resource?: string;
}

export const ROLE_PERMISSIONS: Record<Role, Permission[]> = {
  [Role.OWNER]: [
    { mode: '*', action: 'admin' },
  ],
  [Role.ADMIN]: [
    { mode: '*', action: 'edit' },
    { mode: '*', action: 'create' },
    { mode: '*', action: 'delete' },
  ],
  [Role.MEMBER]: [
    { mode: '*', action: 'view' },
    { mode: '*', action: 'create' },
    { mode: '*', action: 'edit' },
  ],
  [Role.VIEWER]: [
    { mode: '*', action: 'view' },
  ],
};
```

## –≠—Ç–∞–ø—ã –º–∏–≥—Ä–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–Ω–µ–¥–µ–ª—è 1)
- [x] –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î –¥–ª—è multi-tenancy
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ RLS –ø–æ–ª–∏—Ç–∏–∫ (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–µ)
- [x] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### –§–∞–∑–∞ 2: –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ (–Ω–µ–¥–µ–ª—è 2)
- [x] –°–æ–∑–¥–∞–Ω–∏–µ PlatformShell —Å Header
- [x] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ModeSwitcher
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Mode Registry
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ /finance

### –§–∞–∑–∞ 3: –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–Ω–µ–¥–µ–ª—è 3)
- [x] –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ (/admin/settings) –∏ —Ä–µ–∂–∏–º–Ω—ã–µ (/finance/settings)
- [x] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π
- [x] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–æ–ª—è–º–∏
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–∂–∏–º–∞ –§–∏–Ω–∞–Ω—Å—ã (22 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ + –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ + –ø–ª–∞–Ω—ã)
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Telegram, n8n, Slack, Email)

### –§–∞–∑–∞ 4: –ó–∞–≥–ª—É—à–∫–∏ –Ω–æ–≤—ã—Ö —Ä–µ–∂–∏–º–æ–≤ (–Ω–µ–¥–µ–ª—è 4)
- [x] –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ - –∫–∞—Ä–∫–∞—Å
- [x] –õ–∏—á–Ω—ã–µ - –∫–∞—Ä–∫–∞—Å
- [x] –¢–µ–Ω–¥–µ—Ä—ã - –∫–∞—Ä–∫–∞—Å
- [x] Placeholder –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§–∞–∑–∞ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [x] E2E —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ (—á–µ—Ä–µ–∑ Playwright)
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ RLS –∏ –∏–∑–æ–ª—è—Ü–∏–∏
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### Backward Compatibility

–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API endpoints —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:
```
/api/transactions -> /api/finance/transactions (redirect)
/api/budgets -> /api/finance/budgets (redirect)
/api/categories -> /api/finance/categories (redirect)
```

### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API

```
/api/v2/
‚îú‚îÄ‚îÄ org/                          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ [orgId]/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ members/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ integrations/
‚îÇ
‚îú‚îÄ‚îÄ finance/                      # –†–µ–∂–∏–º –§–∏–Ω–∞–Ω—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ transactions/
‚îÇ   ‚îú‚îÄ‚îÄ budgets/
‚îÇ   ‚îî‚îÄ‚îÄ analytics/
‚îÇ
‚îú‚îÄ‚îÄ investments/                  # –†–µ–∂–∏–º –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
‚îú‚îÄ‚îÄ personal/                     # –†–µ–∂–∏–º –õ–∏—á–Ω—ã–µ
‚îî‚îÄ‚îÄ tenders/                      # –†–µ–∂–∏–º –¢–µ–Ω–¥–µ—Ä—ã
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### Telegram
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- –û—Ç—á—ë—Ç—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É

### n8n
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ –±–∞–Ω–∫–æ–≤
- Webhook –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ workflow

### –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
```typescript
// lib/integrations/registry.ts
export interface Integration {
  type: string;
  name: string;
  icon: string;
  configSchema: z.ZodSchema;
  setup: (config: any) => Promise<void>;
  teardown: () => Promise<void>;
}

export const INTEGRATIONS: Record<string, Integration> = {
  telegram: { /* ... */ },
  n8n: { /* ... */ },
  // –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ
};
```

## AI –≤–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö

–ö–∞–∂–¥—ã–π —Ä–µ–∂–∏–º –∏–º–µ–µ—Ç AI-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

### –§–∏–Ω–∞–Ω—Å—ã
- AI –°–æ–≤–µ—Ç–Ω–∏–∫
- AI –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- –£–º–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è

### –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ (–±—É–¥—É—â–µ–µ)
- –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ
- –ü—Ä–æ–≥–Ω–æ–∑—ã –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏

### –õ–∏—á–Ω—ã–µ (–±—É–¥—É—â–µ–µ)
- –£–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–º–µ—Ç–æ–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—é–º–µ

### –¢–µ–Ω–¥–µ—Ä—ã (–±—É–¥—É—â–µ–µ)
- –ê–Ω–∞–ª–∏–∑ —Ç–µ–Ω–¥–µ—Ä–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
- –û—Ü–µ–Ω–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ–±–µ–¥—ã

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º
- –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- –û—à–∏–±–∫–∏ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **RLS –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö**
2. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ credentials –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**
3. **–ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
4. **Rate limiting per org**
5. **CSRF protection**

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∂–∏–º–æ–≤
- Prefetch –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ ModeSwitcher
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ Mode Registry
- –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ISR –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
npm run db:migrate

# –°–±–æ—Ä–∫–∞
npm run build

# –ó–∞–ø—É—Å–∫
npm start
```

## Monitoring Checklist

- [ ] Vercel Analytics –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤
- [ ] Sentry –¥–ª—è –æ—à–∏–±–æ–∫
- [ ] Supabase logs –¥–ª—è RLS violations
- [ ] Custom metrics –¥–ª—è mode usage

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Mode Registry –∏ PlatformShell

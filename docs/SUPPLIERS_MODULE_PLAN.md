# ÐŸÐ»Ð°Ð½ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¼Ð¾Ð´ÑƒÐ»Ñ "ÐŸÐ¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¸"

**Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð°:** 13 Ð´ÐµÐºÐ°Ð±Ñ€Ñ 2024  
**ÐŸÑ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€ IP-Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸Ð¸:** Mango Office  
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** ðŸ”„ Ð’ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ

---

## ÐžÐ³Ð»Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ

1. [ÐšÐ¾Ð½Ñ†ÐµÐ¿Ñ†Ð¸Ñ](#ÐºÐ¾Ð½Ñ†ÐµÐ¿Ñ†Ð¸Ñ)
2. [ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°](#Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°)
3. [Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð‘Ð”](#ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°-Ð±Ð´)
4. [API Mango Office](#api-mango-office)
5. [Ð­Ñ‚Ð°Ð¿Ñ‹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸](#ÑÑ‚Ð°Ð¿Ñ‹-Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸)

---

## ÐšÐ¾Ð½Ñ†ÐµÐ¿Ñ†Ð¸Ñ

ÐœÐ¾Ð´ÑƒÐ»ÑŒ **"ÐŸÐ¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¸"** â€” Ð¿Ð¾Ð»Ð½Ð¾Ñ†ÐµÐ½Ð½Ð°Ñ CRM-Ð¿Ð¾Ð´ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°Ð¼Ð¸ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð².

### ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

- **Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°Ð¼Ð¸** â€” ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸, ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹, ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸, Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³
- **Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð¾Ð±Ð¾Ñ€Ð¾Ñ‚** â€” ÐšÐŸ, ÑÑ‡ÐµÑ‚Ð°, Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñ‹, Ð¿Ñ€Ð°Ð¹Ñ-Ð»Ð¸ÑÑ‚Ñ‹
- **Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸** â€” Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹
- **Ð¡Ð²ÑÐ·ÑŒ Ñ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ð¼Ð¸** â€” ÑƒÑ‡Ð°ÑÑ‚Ð¸Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² Ð² Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ñ…
- **Ð¡Ð²ÑÐ·ÑŒ Ñ Ð±ÑƒÑ…Ð³Ð°Ð»Ñ‚ÐµÑ€Ð¸ÐµÐ¹** â€” ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ ÐºÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚Ð°Ð¼Ð¸
- **IP-Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸Ñ (Mango Office)** â€” Ð·Ð²Ð¾Ð½ÐºÐ¸, Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ, Ð²ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ðµ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸

---

## ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°

### Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ„Ð°Ð¹Ð»Ð¾Ð²

```text
app/(protected)/tenders/suppliers/
â”œâ”€â”€ page.tsx                    # Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð²
â”œâ”€â”€ layout.tsx                  # Layout Ñ Ð½Ð°Ð²Ð¸Ð³Ð°Ñ†Ð¸ÐµÐ¹
â”œâ”€â”€ [id]/
â”‚   â””â”€â”€ page.tsx               # ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°
â”œâ”€â”€ categories/
â”‚   â””â”€â”€ page.tsx               # ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð²
â”œâ”€â”€ calls/
â”‚   â””â”€â”€ page.tsx               # Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð²
â””â”€â”€ settings/
    â””â”€â”€ page.tsx               # ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸Ð¸

app/api/telephony/
â”œâ”€â”€ mango/
â”‚   â”œâ”€â”€ call/route.ts          # Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ñ†Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ°
â”‚   â”œâ”€â”€ webhook/route.ts       # Webhook Ð¾Ñ‚ Mango
â”‚   â””â”€â”€ events/route.ts        # SSE Ð´Ð»Ñ realtime ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹
â””â”€â”€ lookup/route.ts            # ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ° Ð¿Ð¾ Ð½Ð¾Ð¼ÐµÑ€Ñƒ

components/suppliers/
â”œâ”€â”€ SuppliersPage.tsx          # Ð“Ð»Ð°Ð²Ð½Ð°Ñ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð°
â”œâ”€â”€ SupplierCard.tsx           # ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°
â”œâ”€â”€ SupplierForm.tsx           # Ð¤Ð¾Ñ€Ð¼Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ/Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
â”œâ”€â”€ SupplierContacts.tsx       # ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹
â”œâ”€â”€ SupplierNotes.tsx          # Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸
â”œâ”€â”€ SupplierFiles.tsx          # Ð¤Ð°Ð¹Ð»Ñ‹
â”œâ”€â”€ SupplierCalls.tsx          # Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð²
â”œâ”€â”€ SupplierTenders.tsx        # Ð¡Ð²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ñ‚ÐµÐ½Ð´ÐµÑ€Ñ‹
â”œâ”€â”€ SupplierDocuments.tsx      # Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð±ÑƒÑ…Ð³Ð°Ð»Ñ‚ÐµÑ€Ð¸Ð¸
â”œâ”€â”€ CategoriesPage.tsx         # Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸
â”œâ”€â”€ CallsHistoryPage.tsx       # Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð²
â”œâ”€â”€ TelephonySettingsPage.tsx  # ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Mango Office
â”œâ”€â”€ CallButton.tsx             # ÐšÐ½Ð¾Ð¿ÐºÐ° Ð·Ð²Ð¾Ð½ÐºÐ°
â”œâ”€â”€ IncomingCallPopup.tsx      # Ð’ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ°
â”œâ”€â”€ ActiveCallWidget.tsx       # Ð’Ð¸Ð´Ð¶ÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð·Ð²Ð¾Ð½ÐºÐ°
â””â”€â”€ CallProvider.tsx           # React Context Ð´Ð»Ñ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸Ð¸

lib/suppliers/
â”œâ”€â”€ types.ts                   # TypeScript Ñ‚Ð¸Ð¿Ñ‹
â”œâ”€â”€ service.ts                 # CRUD Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸
â”œâ”€â”€ mango-service.ts           # Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ Mango Office
â””â”€â”€ file-service.ts            # Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ñ„Ð°Ð¹Ð»Ð°Ð¼Ð¸
```

---

## Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð‘Ð”

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `suppliers`

```sql
CREATE TABLE suppliers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  company_id UUID NOT NULL REFERENCES companies(id),
  user_id UUID NOT NULL REFERENCES auth.users(id),
  
  -- ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ
  name VARCHAR(500) NOT NULL,
  short_name VARCHAR(200),
  inn VARCHAR(12),
  kpp VARCHAR(9),
  ogrn VARCHAR(15),
  
  -- ÐÐ´Ñ€ÐµÑÐ°
  legal_address TEXT,
  actual_address TEXT,
  
  -- ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸
  phone VARCHAR(50),
  email VARCHAR(255),
  website VARCHAR(500),
  
  -- ÐšÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ
  category_id UUID REFERENCES supplier_categories(id),
  status VARCHAR(20) DEFAULT 'active' CHECK (status IN ('active', 'inactive', 'blacklisted')),
  rating SMALLINT CHECK (rating >= 1 AND rating <= 5),
  tags TEXT[],
  
  -- Ð¡Ð²ÑÐ·ÑŒ Ñ Ð±ÑƒÑ…Ð³Ð°Ð»Ñ‚ÐµÑ€Ð¸ÐµÐ¹
  counterparty_id UUID REFERENCES accounting_counterparties(id),
  
  -- ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
  description TEXT,
  
  -- ÐœÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ðµ
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  deleted_at TIMESTAMPTZ
);
```

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `supplier_categories`

```sql
CREATE TABLE supplier_categories (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  company_id UUID NOT NULL REFERENCES companies(id),
  
  name VARCHAR(200) NOT NULL,
  description TEXT,
  color VARCHAR(7) DEFAULT '#6366f1',
  icon VARCHAR(50) DEFAULT 'Package',
  parent_id UUID REFERENCES supplier_categories(id),
  sort_order INTEGER DEFAULT 0,
  
  created_at TIMESTAMPTZ DEFAULT now()
);
```

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `supplier_contacts`

```sql
CREATE TABLE supplier_contacts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,
  
  name VARCHAR(300) NOT NULL,
  position VARCHAR(200),
  department VARCHAR(200),
  
  phone VARCHAR(50),
  phone_mobile VARCHAR(50),
  phone_internal VARCHAR(20),
  email VARCHAR(255),
  telegram VARCHAR(100),
  
  is_primary BOOLEAN DEFAULT false,
  is_decision_maker BOOLEAN DEFAULT false,
  notes TEXT,
  
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);
```

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `supplier_notes`

```sql
CREATE TABLE supplier_notes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES auth.users(id),
  
  title VARCHAR(300),
  content TEXT NOT NULL,
  is_pinned BOOLEAN DEFAULT false,
  
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);
```

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `supplier_files`

```sql
CREATE TABLE supplier_files (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES auth.users(id),
  
  file_name VARCHAR(500) NOT NULL,
  file_path TEXT NOT NULL,
  file_size BIGINT,
  mime_type VARCHAR(100),
  
  file_type VARCHAR(30) DEFAULT 'other' CHECK (file_type IN (
    'commercial_offer', 'invoice', 'contract', 'price_list', 
    'certificate', 'license', 'other'
  )),
  
  description TEXT,
  tender_id UUID REFERENCES tenders(id),
  
  created_at TIMESTAMPTZ DEFAULT now()
);
```

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `supplier_tenders`

```sql
CREATE TABLE supplier_tenders (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,
  tender_id UUID NOT NULL REFERENCES tenders(id) ON DELETE CASCADE,
  
  role VARCHAR(30) DEFAULT 'participant' CHECK (role IN (
    'participant', 'winner', 'subcontractor', 'partner'
  )),
  status VARCHAR(30) DEFAULT 'invited' CHECK (status IN (
    'invited', 'confirmed', 'submitted', 'rejected', 'won', 'lost'
  )),
  
  proposed_price BIGINT,
  final_price BIGINT,
  notes TEXT,
  
  invited_at TIMESTAMPTZ DEFAULT now(),
  responded_at TIMESTAMPTZ,
  
  UNIQUE(supplier_id, tender_id)
);
```

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `mango_settings`

```sql
CREATE TABLE mango_settings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  company_id UUID NOT NULL REFERENCES companies(id) UNIQUE,
  
  -- API credentials
  api_key VARCHAR(100) NOT NULL,
  api_salt VARCHAR(100) NOT NULL,
  
  -- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
  is_enabled BOOLEAN DEFAULT true,
  record_calls BOOLEAN DEFAULT true,
  
  -- ÐœÐ°Ð¿Ð¿Ð¸Ð½Ð³ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð½Ð° Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ðµ Ð½Ð¾Ð¼ÐµÑ€Ð°
  -- { "user_id": "extension" }
  extension_mapping JSONB DEFAULT '{}',
  
  -- Webhook
  webhook_url TEXT,
  webhook_secret VARCHAR(100),
  
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);
```

### Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `call_history`

```sql
CREATE TABLE call_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  company_id UUID NOT NULL REFERENCES companies(id),
  user_id UUID REFERENCES auth.users(id),
  
  -- Ð¡Ð²ÑÐ·Ð¸
  supplier_id UUID REFERENCES suppliers(id),
  contact_id UUID REFERENCES supplier_contacts(id),
  
  -- Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð²Ð¾Ð½ÐºÐ°
  mango_call_id VARCHAR(100),
  direction VARCHAR(10) NOT NULL CHECK (direction IN ('inbound', 'outbound')),
  
  from_number VARCHAR(50),
  to_number VARCHAR(50),
  extension VARCHAR(20),
  
  -- Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¼ÐµÑ‚ÐºÐ¸
  started_at TIMESTAMPTZ NOT NULL,
  answered_at TIMESTAMPTZ,
  ended_at TIMESTAMPTZ,
  
  duration INTEGER DEFAULT 0,
  talk_duration INTEGER DEFAULT 0,
  
  -- Ð¡Ñ‚Ð°Ñ‚ÑƒÑ
  status VARCHAR(20) NOT NULL CHECK (status IN (
    'ringing', 'answered', 'completed', 'missed', 'busy', 'failed', 'cancelled'
  )),
  
  -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾
  recording_url TEXT,
  notes TEXT,
  
  created_at TIMESTAMPTZ DEFAULT now()
);
```

### Ð˜Ð½Ð´ÐµÐºÑÑ‹

```sql
-- suppliers
CREATE INDEX idx_suppliers_company ON suppliers(company_id);
CREATE INDEX idx_suppliers_category ON suppliers(category_id);
CREATE INDEX idx_suppliers_status ON suppliers(status);
CREATE INDEX idx_suppliers_inn ON suppliers(inn);
CREATE INDEX idx_suppliers_counterparty ON suppliers(counterparty_id);

-- contacts
CREATE INDEX idx_supplier_contacts_supplier ON supplier_contacts(supplier_id);
CREATE INDEX idx_supplier_contacts_phone ON supplier_contacts(phone);
CREATE INDEX idx_supplier_contacts_phone_mobile ON supplier_contacts(phone_mobile);

-- files
CREATE INDEX idx_supplier_files_supplier ON supplier_files(supplier_id);
CREATE INDEX idx_supplier_files_type ON supplier_files(file_type);

-- tenders
CREATE INDEX idx_supplier_tenders_supplier ON supplier_tenders(supplier_id);
CREATE INDEX idx_supplier_tenders_tender ON supplier_tenders(tender_id);

-- calls
CREATE INDEX idx_call_history_company ON call_history(company_id);
CREATE INDEX idx_call_history_supplier ON call_history(supplier_id);
CREATE INDEX idx_call_history_from ON call_history(from_number);
CREATE INDEX idx_call_history_to ON call_history(to_number);
CREATE INDEX idx_call_history_started ON call_history(started_at DESC);
```

### RLS Policies

```sql
-- Ð’ÑÐµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹: Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼ ÑÐ²Ð¾ÐµÐ¹ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸
ALTER TABLE suppliers ENABLE ROW LEVEL SECURITY;
ALTER TABLE supplier_categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE supplier_contacts ENABLE ROW LEVEL SECURITY;
ALTER TABLE supplier_notes ENABLE ROW LEVEL SECURITY;
ALTER TABLE supplier_files ENABLE ROW LEVEL SECURITY;
ALTER TABLE supplier_tenders ENABLE ROW LEVEL SECURITY;
ALTER TABLE mango_settings ENABLE ROW LEVEL SECURITY;
ALTER TABLE call_history ENABLE ROW LEVEL SECURITY;

-- ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ Ð´Ð»Ñ suppliers
CREATE POLICY "Users can view suppliers of their company"
  ON suppliers FOR SELECT
  USING (company_id IN (
    SELECT company_id FROM user_companies WHERE user_id = auth.uid()
  ));

CREATE POLICY "Users can manage suppliers of their company"
  ON suppliers FOR ALL
  USING (company_id IN (
    SELECT company_id FROM user_companies WHERE user_id = auth.uid()
  ));
```

---

## API Mango Office

### ÐÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ

Mango Office Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿Ð¾Ð´Ð¿Ð¸ÑÑŒ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²:

```typescript
import crypto from 'crypto';

function signRequest(apiKey: string, apiSalt: string, params: object): string {
  const json = JSON.stringify(params);
  const sign = crypto
    .createHash('sha256')
    .update(apiKey + json + apiSalt)
    .digest('hex');
  return sign;
}
```

### ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ API

#### 1. Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ñ†Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ°

```http
POST https://app.mango-office.ru/vpbx/commands/callback
```

```typescript
interface CallbackRequest {
  command_id: string;      // Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ID ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
  from: {
    extension: string;     // Ð’Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ð¹ Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°
  };
  to_number: string;       // ÐÐ¾Ð¼ÐµÑ€ Ð´Ð»Ñ Ð·Ð²Ð¾Ð½ÐºÐ°
}
```

#### 2. Webhook ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹

Mango Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð½Ð° Ð½Ð°Ñˆ webhook:

```typescript
interface MangoEvent {
  entry_id: string;        // ID Ð·Ð°Ð¿Ð¸ÑÐ¸
  call_id: string;         // ID Ð·Ð²Ð¾Ð½ÐºÐ°
  timestamp: number;       // Unix timestamp
  seq: number;             // ÐŸÐ¾Ñ€ÑÐ´ÐºÐ¾Ð²Ñ‹Ð¹ Ð½Ð¾Ð¼ÐµÑ€
  
  call_state: 'Appeared' | 'Connected' | 'Disconnected';
  location: 'ivr' | 'queue' | 'abonent';
  
  from: {
    number: string;
    extension?: string;
  };
  to: {
    number: string;
    extension?: string;
  };
  
  disconnect_reason?: number;
  talk_time?: number;
}
```

#### 3. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð°

```http
POST https://app.mango-office.ru/vpbx/queries/recording/post
```

---

## Ð­Ñ‚Ð°Ð¿Ñ‹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸

### Ð­Ñ‚Ð°Ð¿ 1: Ð¤ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚ âœ…

- [x] 1.1 Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ð»Ð°Ð½ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ (ÑÑ‚Ð¾Ñ‚ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚)
- [x] 1.2 SQL-Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ Ð²ÑÐµÑ… Ñ‚Ð°Ð±Ð»Ð¸Ñ†
- [x] 1.3 TypeScript Ñ‚Ð¸Ð¿Ñ‹ (`lib/suppliers/types.ts`)
- [x] 1.4 Layout Ñ Ð½Ð°Ð²Ð¸Ð³Ð°Ñ†Ð¸ÐµÐ¹ (`layout.tsx`)
- [x] 1.5 Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² Ð¼ÐµÐ½ÑŽ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð²

### Ð­Ñ‚Ð°Ð¿ 2: CRUD Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² âœ…

- [x] 2.1 Ð¡ÐµÑ€Ð²Ð¸ÑÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ (`lib/suppliers/service.ts`)
- [x] 2.2 Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ð¼Ð¸
- [x] 2.3 Ð¤Ð¾Ñ€Ð¼Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ/Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
- [x] 2.4 ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ° (Ð±Ð°Ð·Ð¾Ð²Ð°Ñ)
- [x] 2.5 Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ° (soft delete)

### Ð­Ñ‚Ð°Ð¿ 3: ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ âœ…

- [x] 3.1 CRUD ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹
- [x] 3.2 Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸
- [x] 3.3 Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼ Ð² ÑÐ¿Ð¸ÑÐºÐµ

### Ð­Ñ‚Ð°Ð¿ 4: ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ âœ…

- [x] 4.1 CRUD ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð²
- [x] 4.2 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð² Ð² ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐµ
- [x] 4.3 ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚, decision maker

### Ð­Ñ‚Ð°Ð¿ 5: Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸ âœ…

- [x] 5.1 CRUD Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº
- [x] 5.2 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº Ð² ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐµ
- [x] 5.3 Ð—Ð°ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº

### Ð­Ñ‚Ð°Ð¿ 6: Ð¤Ð°Ð¹Ð»Ñ‹ âœ…

- [x] 6.1 Supabase Storage bucket
- [x] 6.2 Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð²
- [x] 6.3 ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð²
- [x] 6.4 ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¸ ÑÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ðµ
- [x] 6.5 ÐŸÑ€Ð¸Ð²ÑÐ·ÐºÐ° Ðº Ñ‚ÐµÐ½Ð´ÐµÑ€Ñƒ

### Ð­Ñ‚Ð°Ð¿ 7: Ð¡Ð²ÑÐ·ÑŒ Ñ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ð¼Ð¸ âœ…

- [x] 7.1 CRUD ÑÐ²ÑÐ·ÐµÐ¹ supplier_tenders
- [x] 7.2 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð² Ð² ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐµ
- [ ] 7.3 Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ° Ð¸Ð· Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°

### Ð­Ñ‚Ð°Ð¿ 8: Ð¡Ð²ÑÐ·ÑŒ Ñ Ð±ÑƒÑ…Ð³Ð°Ð»Ñ‚ÐµÑ€Ð¸ÐµÐ¹ âœ…

- [x] 8.1 Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ ÐºÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚Ð°Ð¼Ð¸
- [x] 8.2 ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²
- [x] 8.3 Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð·Ð°ÐºÑƒÐ¿Ð¾Ðº

### Ð­Ñ‚Ð°Ð¿ 9: IP-Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸Ñ (Mango Office) âœ…

- [x] 9.1 ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Mango Office
- [x] 9.2 API Ð´Ð»Ñ Ð¸ÑÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ð·Ð²Ð¾Ð½ÐºÐ¾Ð²
- [x] 9.3 Webhook Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹
- [x] 9.4 CallProvider (React Context)
- [x] 9.5 ÐšÐ½Ð¾Ð¿ÐºÐ° Ð·Ð²Ð¾Ð½ÐºÐ°
- [x] 9.6 Ð’Ð¸Ð´Ð¶ÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð·Ð²Ð¾Ð½ÐºÐ°
- [x] 9.7 Ð’ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´ÑÑ‰ÐµÐ³Ð¾
- [x] 9.8 Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ¾Ð²
- [x] 9.9 Ð—Ð°Ð¿Ð¸ÑÐ¸ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð²

### Ð­Ñ‚Ð°Ð¿ 10: ÐŸÐ¾Ð»Ð¸Ñ€Ð¾Ð²ÐºÐ° âœ…

- [x] 10.1 ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð¿Ð¾Ð»ÑÐ¼ (Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½ Ð² SuppliersPage)
- [x] 10.2 Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ (ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ, ÑÑ‚Ð°Ñ‚ÑƒÑ, Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³)
- [x] 10.3 Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² CSV/Excel (lib/suppliers/export.ts)
- [x] 10.4 ÐœÐ°ÑÑÐ¾Ð²Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ (Ð²Ñ‹Ð±Ð¾Ñ€, Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°/ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸, ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ, ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ)
- [x] 10.5 ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ð°Ñ Ð°Ð´Ð°Ð¿Ñ‚Ð°Ñ†Ð¸Ñ (Ð°Ð´Ð°Ð¿Ñ‚Ð¸Ð²Ð½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°, ÑÐºÑ€Ñ‹Ñ‚Ð¸Ðµ ÐºÐ¾Ð»Ð¾Ð½Ð¾Ðº, ÐºÐ¾Ð¼Ð¿Ð°ÐºÑ‚Ð½Ñ‹Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸)

---

## ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ

| Ð­Ñ‚Ð°Ð¿ | Ð¡Ñ‚Ð°Ñ‚ÑƒÑ | Ð”Ð°Ñ‚Ð° |
|------|--------|------|
| Ð­Ñ‚Ð°Ð¿ 1: Ð¤ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 2: CRUD Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 3: ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 4: ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 5: Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 6: Ð¤Ð°Ð¹Ð»Ñ‹ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 7: Ð¡Ð²ÑÐ·ÑŒ Ñ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ð¼Ð¸ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 8: Ð¡Ð²ÑÐ·ÑŒ Ñ Ð±ÑƒÑ…Ð³Ð°Ð»Ñ‚ÐµÑ€Ð¸ÐµÐ¹ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 9: IP-Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸Ñ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 10: ÐŸÐ¾Ð»Ð¸Ñ€Ð¾Ð²ÐºÐ° | âœ… | 13.12.2024 |

**Ð›ÐµÐ³ÐµÐ½Ð´Ð°:** âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾ | ðŸ”„ Ð’ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ | â³ ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚

---

## Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð» (v2.0)

### Ð­Ñ‚Ð°Ð¿ 11: ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð¸ Ð·Ð°Ð´Ð°Ñ‡Ð¸ âœ…

- [x] 11.1 SQL: Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° supplier_tasks
- [x] 11.2 TypeScript Ñ‚Ð¸Ð¿Ñ‹ Ð´Ð»Ñ Ð·Ð°Ð´Ð°Ñ‡
- [x] 11.3 CRUD ÑÐµÑ€Ð²Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡ (tasks-service.ts)
- [x] 11.4 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ ÑÐ¿Ð¸ÑÐºÐ° Ð·Ð°Ð´Ð°Ñ‡ (SupplierTasks.tsx)
- [x] 11.5 Ð¤Ð¾Ñ€Ð¼Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡Ð¸
- [ ] 11.6 Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾ ÑÑ€Ð¾ÐºÐ°Ñ… (CRON) - TODO
- [x] 11.7 Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ð² ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÑƒ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°

### Ð­Ñ‚Ð°Ð¿ 12: Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ (Activity Log) âœ…

- [x] 12.1 SQL: Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° supplier_activities
- [x] 12.2 ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ (logActivity)
- [x] 12.3 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð»ÐµÐ½Ñ‚Ñ‹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ (SupplierActivityLog.tsx)
- [x] 12.4 Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð¿Ð¾ Ñ‚Ð¸Ð¿Ñƒ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸
- [x] 12.5 ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð² (addComment)

### Ð­Ñ‚Ð°Ð¿ 13: Ð”Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñ‹ Ð¸ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ âœ…

- [x] 13.1 SQL: Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° supplier_contracts
- [x] 13.2 CRUD ÑÐµÑ€Ð²Ð¸Ñ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð² (contracts-service.ts)
- [x] 13.3 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ ÑÐ¿Ð¸ÑÐºÐ° Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð² (SupplierContracts.tsx)
- [x] 13.4 Ð£ÑÐ»Ð¾Ð²Ð¸Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹ (Ð¾Ñ‚ÑÑ€Ð¾Ñ‡ÐºÐ°, Ð¿Ñ€ÐµÐ´Ð¾Ð¿Ð»Ð°Ñ‚Ð°)
- [x] 13.5 Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ð¸ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð° (isExpiringSoon)
- [ ] 13.6 Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÑÐºÐ°Ð½Ð¾Ð² Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð² - TODO

### Ð­Ñ‚Ð°Ð¿ 14: Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² âœ…

- [x] 14.1 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² Ð´Ð»Ñ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ (SupplierComparison.tsx)
- [x] 14.2 Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ Ð¿Ð¾ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÑÐ¼
- [x] 14.3 Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²
- [ ] 14.4 Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ñ†ÐµÐ½ (SQL + UI) - TODO
- [x] 14.5 Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ (CSV)

### Ð­Ñ‚Ð°Ð¿ 15: Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ âœ…

- [x] 15.1 SQL Ð°Ð³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸ (analytics-service.ts)
- [x] 15.2 Ð¢Ð¾Ð¿ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² Ð¿Ð¾ Ð¾Ð±ÑŠÑ‘Ð¼Ñƒ Ð·Ð°ÐºÑƒÐ¿Ð¾Ðº
- [x] 15.3 Ð”Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ (Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸)
- [x] 15.4 ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð½Ñ‹Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¸ (Ð¿Ñ€Ð¾ÑÑ€Ð¾Ñ‡ÐºÐ¸, Ð¿Ñ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ñ)
- [ ] 15.5 KPI Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð² Ð¿Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ Ñ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°Ð¼Ð¸ - TODO

### Ð­Ñ‚Ð°Ð¿ 16: Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ email âœ…

- [x] 16.1 SQL: Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ supplier_emails, supplier_email_templates
- [x] 16.2 Ð¨Ð°Ð±Ð»Ð¾Ð½Ñ‹ Ð¿Ð¸ÑÐµÐ¼ (email-service.ts)
- [x] 16.3 ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° email Ð¸Ð· ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ (SupplierEmailComposer.tsx)
- [x] 16.4 Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ¸
- [ ] 16.5 ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¿Ñ€Ð¸Ð²ÑÐ·ÐºÐ° Ð²Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ð¿Ð¸ÑÐµÐ¼ - TODO

### Ð­Ñ‚Ð°Ð¿ 17: ÐŸÑ€Ð°Ð¹Ñ-Ð»Ð¸ÑÑ‚Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² âœ…

- [x] 17.1 SQL: Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° supplier_pricelists (ÑƒÐ¶Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð° Ð² v2)
- [x] 17.2 Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð°Ð¹ÑÐ¾Ð² (pricelist-service.ts)
- [x] 17.3 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ SupplierPricelists.tsx
- [ ] 17.4 ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ Excel Ð¿Ñ€Ð°Ð¹ÑÐ¾Ð² - TODO
- [ ] 17.5 Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½ Ð¼ÐµÐ¶Ð´Ñƒ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°Ð¼Ð¸ - TODO

### Ð­Ñ‚Ð°Ð¿ 18: ÐžÑ†ÐµÐ½ÐºÐ° Ð¸ Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹ âœ…

- [x] 18.1 SQL: Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° supplier_reviews (ÑƒÐ¶Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð° Ð² v2)
- [x] 18.2 Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð¾Ñ†ÐµÐ½ÐºÐ¸ Ð¿Ð¾ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÑÐ¼ (ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾, Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°, Ñ†ÐµÐ½Ð°, ÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ñ)
- [x] 18.3 ÐžÑ‚Ð·Ñ‹Ð²Ñ‹ Ð¾Ñ‚ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² (reviews-service.ts)
- [x] 18.4 ÐÐ³Ñ€ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÑÐºÐ¾Ñ€Ð¸Ð½Ð³ (Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ñ€Ð°ÑÑ‡Ñ‘Ñ‚ overall_rating)
- [x] 18.5 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð² ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐµ (SupplierReviews.tsx)

### Ð­Ñ‚Ð°Ð¿ 19: Ð“ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ñ âœ…

- [x] 19.1 ÐŸÐ¾Ð»Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ suppliers (latitude, longitude, geocoded_at)
- [x] 19.2 ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ SuppliersMap.tsx Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸ÐµÐ¼ Ð² Ð¯Ð½Ð´ÐµÐºÑ.ÐšÐ°Ñ€Ñ‚Ð°Ñ…
- [x] 19.3 Ð¡ÐµÑ€Ð²Ð¸Ñ geolocation-service.ts
- [x] 19.4 Ð Ð°ÑÑ‡Ñ‘Ñ‚ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ (Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð° Haversine)
- [x] 19.5 Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ñ€Ð°Ð´Ð¸ÑƒÑÑƒ
- [x] 19.6 Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° /tenders/suppliers/map

### Ð­Ñ‚Ð°Ð¿ 20: Ð”ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ Ð¸ ÑÐ»Ð¸ÑÐ½Ð¸Ðµ âœ…

- [x] 20.1 ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² Ð¿Ð¾ Ð˜ÐÐ, Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ, email, Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ
- [x] 20.2 UI ÑÐ¿Ð¸ÑÐºÐ° Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² (SuppliersDuplicates.tsx)
- [x] 20.3 Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ ÑÐ»Ð¸ÑÐ½Ð¸Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ð¼ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹
- [x] 20.4 ÐŸÐµÑ€ÐµÐ½Ð¾Ñ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸ ÑÐ»Ð¸ÑÐ½Ð¸Ð¸ (ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹, Ñ„Ð°Ð¹Ð»Ñ‹, Ð·Ð°Ð´Ð°Ñ‡Ð¸, Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñ‹ Ð¸ Ð´Ñ€.)
- [x] 20.5 Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° /tenders/suppliers/duplicates

---

## ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ v2.0

| Ð­Ñ‚Ð°Ð¿ | Ð¡Ñ‚Ð°Ñ‚ÑƒÑ | Ð”Ð°Ñ‚Ð° |
|------|--------|------|
| Ð­Ñ‚Ð°Ð¿ 11: ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð¸ Ð·Ð°Ð´Ð°Ñ‡Ð¸ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 12: Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 13: Ð”Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñ‹ Ð¸ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 14: Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð² | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 15: Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 16: Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ email | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 17: ÐŸÑ€Ð°Ð¹Ñ-Ð»Ð¸ÑÑ‚Ñ‹ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 18: ÐžÑ†ÐµÐ½ÐºÐ° Ð¸ Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 19: Ð“ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ñ | âœ… | 13.12.2024 |
| Ð­Ñ‚Ð°Ð¿ 20: Ð”ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ Ð¸ ÑÐ»Ð¸ÑÐ½Ð¸Ðµ | âœ… | 13.12.2024 |

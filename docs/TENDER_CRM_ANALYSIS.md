# Анализ CRM-конкурента (ip-domasnix.ztcs.biz)

## 1. Краткое резюме

- Система ориентирована на полный цикл работы с тендерами: от поиска и подачи заявок до постконтрактного сопровождения и контроля оплат.
- Архитектура построена на модульном подходе: отдельные разделы для тендерного отдела, реализации, календаря, задач, отчетов, справочников и настроек.
- Основной фокус — прозрачность этапов, распределение ответственности между ролями и контроль денежных потоков.

## 2. Карта разделов и ключевой функционал

| Раздел | Назначение | Наблюдаемые функции |
| --- | --- | --- |
| **Тендеры** | Централизованный реестр тендеров | Табличный список с 25+ колонками, поиск, фильтры, ручное добавление или импорт по номеру из госзакупок, настройка видимости столбцов, табы «В работе / Архив / Все» |
| **Тендерный отдел (этапы 1-ой категории)** | Канбан по предконтрактным этапам | 10 стадий (от «Анализ и просчёт» до «Договор не заключен»), быстрые фильтры по ответственным, агрегаты по сумме и прибыли, массовые действия «Перенести в архив», «Только активные этапы», кнопка «Перенести из Тендерплана» |
| **Реализация (этапы 2-ой категории)** | Канбан по постконтрактным стадиям | Этапы «Новые контракты», «Ждём заявки», «Поставка», «Оплата», «Под вопросом», блок «Заявки» с подэтапами оплаты, фильтры по менеджеру/тендерному специалисту/реализатору |
| **Календарь** | Планирование событий | Просмотр «Месяц/Неделя/День», навигация по датам, фильтр-панель, интеграция с задачами |
| **Задачи** | Управление задачами сотрудников | Табы «Мои / Контроль / Все / Возврат / Склад», таблица с расширенными колонками, фильтры, статусы |
| **Отчёты** | Аналитика и контроль показателей | 8+ преднастроенных отчётов (тендерный отдел, реализация, реестр оплат, статистика, показатели менеджера, линейка обеспечения, деньги у заказчиков, отчёт по выплатам) |
| **Справочники** | Нормативные данные | Типы тендеров, ответственные за этапы, шаблоны задач по тендерам и заявкам, юрлица, поставщики |
| **Настройки** | Бизнес-параметры | Настройка налогов, распределения процентов между участниками (инвестор, просчётчик, реализация, УК), контроль подтверждения выплат |

## 3. Пользовательские сценарии

1. **Регистрация нового тендера**: поиск по номеру закупки → автозаполнение карточки → распределение ролей → попадание в канбан 1-й категории.
2. **Продвижение по этапам**: ответственные обновляют статус на канбан-доске, система считает суммарные показатели по колонкам.
3. **Передача в реализацию**: через кнопку «Перенести из Тендерплана» или смену статуса тендер попадает во 2-ю категорию для исполнения контракта и контроля платежей.
4. **Контроль задач**: менеджеры используют раздел «Задачи» и календарь для планирования дедлайнов, привязаных к тендерам/заявкам.
5. **Финансовый учет**: отчёты «Реестр оплат», «Линейка деньги у заказчиков» обеспечивают мониторинг задолженностей.
6. **Администрирование**: через «Настройки» задаются модели распределения прибыли и включаются обязательные подтверждения оплат.

## 3.1. Детальное исследование работы CRM (проведен тендер №32515378859)

### Процесс добавления тендера

**Шаг 1: Поиск по номеру госзакупки**
- Открывается модальное окно «Добавить закупку» с полем поиска по базе госзакупок
- Пользователь вводит номер закупки (например, 32515378859)
- Система автоматически запрашивает данные из внешней базы (вероятно, API ЕИС)
- Альтернатива: кнопка «добавить вручную» для заполнения полей без автоматического импорта

**Шаг 2: Автозаполнение карточки**
- При успешном поиске открывается форма «Добавление тендера» со следующими **автоматически заполненными** полями:
  - Номер закупки (обязательное)
  - Способ определения (например, «Запрос котировок в электронной форме»)
  - Тип / ФЗ-ПП (например, «ФЗ-223»)
  - Заказчик (полное наименование организации)
  - Предмет закупки (обязательное)
  - Площадка (например, «ZakazRF (223)»)
  - НМЦК в рублях (обязательное, например, 1 720 439.67)
  - Обеспечение заявки (сумма, например, 20 645.28)
  - Дата окончания подачи заявки с временем (обязательное)
  - Дата подведения итогов
  - Обеспечение контракта (опционально)
  - Проект (опционально)
  - Даты проведения аукциона и рассмотрения заявки (опционально)

**Шаг 3: Сохранение**
- Кнопка «добавить тендер» создаёт запись в БД
- Система показывает уведомление «Сохранено»
- Тендер автоматически попадает на начальный этап «Анализ и просчёт»
- Присваивается внутренний номер проекта (например, № 6507)
- По умолчанию ответственный менеджер устанавливается как текущий пользователь

### Детальная карточка тендера

После добавления открывается карточка проекта со следующими **вкладками**:

1. **Основная информация** (активна по умолчанию)
2. **Задачи** — связанные задачи по тендеру
3. **Файлы** — прикреплённые документы
4. **Затраты по контракту** — финансовая детализация
5. **Контакты контрагентов** — контактная информация

**Блоки основной информации:**

**A. Начальные данные** (неизменяемые после импорта):
- Проект, Номер закупки, НМЦК, Способ определения
- Обеспечение заявки, ФЗ/ПП, Обеспечение контракта
- Предмет закупки, Площадка, Ссылка на ЕИС
- Все ключевые даты с возможностью выбора времени

**B. Просчёт тендера** (заполняется менеджером):
- Ответственный менеджер (выбирается из списка сотрудников)
- Цикл сделки (дней)
- **Закупка** — поле обязательно для заполнения (валидируется при переводе на следующий этап)
- Процент инвестора (автоматически, настраивается в системе, по умолчанию 5%)
- Логистика (сумма)
- Цена для торгов
- Прочие затраты
- Планируемая прибыль (автоматически рассчитывается)
- Сумма прямых затрат (автоматически рассчитывается из Закупка + Логистика + Прочие)

**C. Риски** (анализ условий):
- Срок поставки по ТЗ / Факт.сроки поставки (дней)
- Место поставки, Количество мест поставки
- Монтаж, Разгрузка (выпадающие списки)
- Штрафы
- Проверка заказчика / поставщика (текстовые поля для комментариев)

**D. Обратить внимание** (критичные условия):
- Гособорон заказ (выпадающий список: Да/Нет)
- Нац. режим
- Условие поставки (например, «Единовременная поставка»)
- Длительная гарантия, Срок оплаты, Срок приемки
- Срок действия контракта
- Запросы на разъяснения, Другое

**E. Результат** (итоги тендера):
- Цена контракта (руб.)
- Прогнозируемая прибыль менеджера (автоматически рассчитывается на основе процентов)
- Ответственный тендерный специалист (выбирается из списка)
- Юр. лицо (выбирается из справочника)
- Инвестор — переключатель «Показать тендер инвесторам»

**Панель управления этапом** (справа от формы):
- Отображение текущего этапа
- «Кто назначил / Кому назначил» — история передачи ответственности
- «Этап начат» — дата и время
- Кнопка «Перевести» — перевод на следующий этап
- Ссылка на список задач по тендеру

### Процесс перемещения по этапам

**Нажатие кнопки «Перевести»** открывает модальное окно «Перемещение контракта» со следующими элементами:

**Отображаемая информация:**
- Проект № и текущий ответственный
- № ЕИС (кликабельный, открывает карточку на zakupki.gov.ru)
- Текущий этап

**Поля для заполнения:**
- **Переместить на этап** — выпадающий список с доступными этапами (валидируется в зависимости от текущего этапа)
  - Из «Анализ и просчёт» доступны: «Проверка», «Не участвуем (после анализа)»
  - Из «Проверка» доступны: «Подача», «Не участвуем (после проверки)»
- **Роль ответственного сотрудника** — выбор роли (например, «Администратор Компании», «Менеджер»)
- **Выберите значение** — выбор конкретного сотрудника с выбранной ролью (автозаполняется если роль однозначна)
- **Дата окончания подачи заявки** — дата с временем (обязательное поле)
- **Комментарий** — текстовое поле для пояснений

**Валидация:**
- Система требует обязательного заполнения роли и сотрудника
- При отсутствии сотрудников с выбранной ролью показывает «Ничего не найдено»
- После успешного перевода система показывает уведомление «Сохранено»

### Канбан-доска тендерного отдела (этапы 1-ой категории)

**Структура доски:**

**Верхняя панель:**
- Кнопки: «Добавить тендер», «Перенести из Тендерплана»
- Быстрые фильтры: «Ответственный менеджер», «Ответственный тендерный специалист»
- Кнопка «Сбросить» фильтры
- Агрегаты: «Тендеров всего», «На сумму», «Чистая прибыль»
- Массовые действия: «Перенести в архив», «Только активные этапы»
- Навигация: кнопки прокрутки канбана влево/вправо

**10 колонок этапов:**

1. **Анализ и просчёт** — начальный этап после добавления тендера
2. **Проверка** — проверка условий и рисков
3. **Подача** — подготовка и отправка заявки
4. **Подан. Рассмотрение заявки** — ожидание решения комиссии
5. **Торги** — участие в электронных торгах/аукционе
6. **Ждём итоги** — ожидание протокола итогов
7. **Победа. Ждём договор** — победа, ожидание договора от заказчика
8. **Заключение договора (Подписание нами)** — подписание со стороны участника
9. **Договор подписан. Ждём заключения** — ожидание подписания заказчиком
10. **Договор не заключен** — отказ/не заключение контракта

**Каждая колонка показывает:**
- Название этапа
- Сумму контрактов на этапе (в рублях)
- Количество тендеров (в скобках)
- Кнопка сворачивания/разворачивания колонки

**Карточка тендера на канбане содержит:**
- Дату окончания подачи заявки (выделена цветом при приближении дедлайна)
- Заказчика (полное наименование)
- Предмет закупки
- НМЦК, Цена для торгов, Затраты(план) — финансовые показатели
- Разделитель
- Проект № и ответственный сотрудник
- Разделитель
- № ЕИС (кликабельный)
- Разделитель
- Площадка

**Взаимодействие:**
- Клик по карточке открывает детальную страницу тендера
- Drag-and-drop карточек между этапами (вероятно, требует подтверждения через модальное окно)
- Три точки (меню) для дополнительных действий

### Наблюдения по работе системы

**Сильные стороны:**
- Полностью автоматическое заполнение карточки по номеру из ЕИС — экономия времени
- Строгая система ролей и назначения ответственных на каждом этапе
- Валидация обязательных полей при переводе между этапами
- Визуальная канбан-доска с финансовыми агрегатами
- Автоматический расчёт прибыли и затрат
- Чёткое разделение этапов с возможностью отслеживания истории передачи

**Слабые стороны:**
- Перегруженная форма карточки тендера (более 50 полей) — сложно ориентироваться
- Отсутствие визуальных индикаторов заполненности карточки (прогресс-бар)
- Нет автоматических подсказок или AI-рекомендаций
- Модальное окно перемещения требует ручного выбора роли и сотрудника каждый раз
- Нет функции массового перевода тендеров между этапами
- Отсутствие графиков и диаграмм прямо на канбане (только числовые агрегаты)
- Нет семантического поиска похожих тендеров или анализа рисков

### Итоги прохождения тендера через этапы

**Проведён тендер №32515378859 через ВСЕ 10 этапов:**

**Этапы 1-ой категории (Тендерный отдел):**

1. **Анализ и просчёт** (начальный) → автоматически после добавления
2. **Проверка** → требует выбор роли + сотрудника
3. **Подача** → требует роль + дата подачи заявки
4. **Подан. Рассмотрение заявки** → требует роль + дата рассмотрения + юр.лицо (опционально)
5. **Торги** → требует роль + дата аукциона + юр.лицо
6. **Ждём итоги** → требует роль + дата подведения итогов
7. **Победа. Ждём договор** → требует роль + **цена контракта (обязательно!)** + планируемая дата завершения + юр.лицо
8. **Заключение договора (Подписание нами)** → требует роль + планируемая дата завершения
9. **Договор подписан. Ждём заключения** → требует роль + планируемая дата завершения

**Переход во 2-ую категорию (Реализация):**

10. **Новые контракты в реализацию** → требует роль + **дата заключения договора (обязательно!)** + планируемая дата завершения + условие поставки + крайняя дата поставки + проект

**Паттерн перемещения между этапами:**
- Модальное окно «Перемещение контракта» с контекстом (№ ЕИС, текущий этап, ответственный)
- Обязательные поля: этап назначения, роль ответственного, конкретный сотрудник
- Опциональные: комментарий, юр.лицо, даты (зависят от этапа)
- После перевода: уведомление «Сохранено» + история действий сохраняется
- Валидация: нельзя перевести без заполнения обязательных полей

**Ключевые находки:**
- Система хранит историю передачи ответственности («Кто назначил / Кому назначил»)
- Время начала каждого этапа фиксируется автоматически
- При переходе между этапами доступны только **логически следующие** этапы (нельзя перепрыгнуть)
- Система отправляет уведомления при смене этапа (вероятно email + внутри системы)
- Каждый этап имеет свои специфические поля (даты, документы)
- **Важно**: после этапа 7 появляются доступные для выбора следующие этапы:
  - Заключение договора (Подписание нами) — этап 8
  - Договор подписан. Ждём заключения — этап 9
  - Договор не заключен — финальный отказ
- **Критичная валидация**: начиная с этапа "Победа", обязательно заполнение цены контракта

**Альтернативные ветки (доступные на разных этапах):**
- После "Проверка": «Не участвуем (после проверки)»
- После "Подача": «Не участвуем (после этапа подача)»
- После "Подан. Рассмотрение заявки": «Заявку отклонили»
- После "Торги": «Проиграли», «Проиграли 44 ФЗ», «Отклонили по 2-ой части»
- После "Ждём итоги": «Проиграли», «Проиграли 44 ФЗ», «Отклонили по 2-ой части»

### 3.2. Этапы реализации контракта (2-ая категория)

**После прохождения тендерных этапов контракт переходит во 2-ую категорию — "Реализация".**

#### Этапы контракта в реализации

1. **Новые контракты в реализацию** (стартовый этап после заключения договора)
   - Назначается ответственный реализатор
   - Фиксируется дата заключения договора
   - Условия поставки, крайняя дата поставки

2. **Контракты «Ждём заявки»**
   - Контракт ожидает создания заявок/счетов от поставщиков
   - Назначение ответственного исполнителя

3. **Контракты в поставке (есть открытые сделки)**
   - Активный этап с открытыми заявками
   - Работа ведется на уровне отдельных заявок (см. ниже)

#### Система заявок — канбан жизненного цикла поставки

**При переходе в "Контракты в поставке" открывается вкладка "Реализация (заявки / сделки)"** — это отдельный канбан для управления заявками внутри контракта.

**Создание заявки:**
- № заявки (автоинкремент)
- Сумма продажи заявки
- Счет поставщика (№, наименование, сумма)
- Можно добавлять несколько счетов к одной заявке

**9 этапов жизненного цикла заявки:**

1. **Оплата счетов. ОСНОВНАЯ ЗАКУПКА**
   - Стартовый этап для новой заявки
   - Ожидание оплаты поставщику

2. **Ожидание готовности продукции / ожидание других счетов**
   - Оплачено, ждем изготовления или других партий

3. **Логистика**
   - Организация доставки
   - Назначение ответственного логиста

4. **Товар в пути**
   - Отслеживание транспортировки
   - Назначение ответственного

5. **Товар у заказчика**
   - Товар доставлен, идет приемка

6. **Товар не приняли**
   - Альтернативная ветка при отказе заказчика
   - Требует разбора причин

7. **Товар поставлен. Ждём оплату**
   - Приемка пройдена, ждем оплаты от заказчика
   - Отслеживание дебиторки

8. **Оплата просрочена**
   - Альтернативная ветка при просрочке платежа
   - Требует работы с долгами

9. **Сделка оплачена. ЗАКРЫТА**
   - Финальный этап, заявка завершена
   - Деньги получены

**Функционал карточки заявки:**

Вкладки:
- **Задачи** — текущие и история задач по заявке
- **Оплата** — информация о платежах
- **Логистика** — данные о доставке
- **Затраты по заявке** — детализация расходов
- **Документы** — вложения

**Аналитика в реализации (дашборд):**
- Всего заявок: количество
- Сумма заявок: общая стоимость
- Сумма тендера: план
- Завершено: сумма и %
- Оплачено: фактическая оплата
- Долг: непогашенная дебиторка
- Поставлено: факт поставки

**Ключевые наблюдения:**

- **Двухуровневая система**: контракт → заявки (счета поставщиков)
- **Детальный контроль**: каждая заявка проходит 9 этапов от оплаты до закрытия
- **Роли на каждом этапе**: логисты, реализаторы, исполнители
- **Финансовый учет**: отслеживание дебиторки, просрочек, фактических выплат
- **Задачи интегрированы**: каждый этап может порождать задачи исполнителям
- **История всех действий**: аудит перемещений между этапами

#### Детальное тестирование этапов реализации (заявка №1)

**Пройденные этапы:**

1. ✅ **Оплата счетов. ОСНОВНАЯ ЗАКУПКА** → автоматически при создании заявки
   - Назначение ответственного исполнителя (роль + сотрудник)

2. ✅ **Ожидание готовности продукции / ожидание других счетов**
   - Роль + исполнитель (автозаполнение предыдущих значений)

3. ✅ **Логистика**
   - Требует: роль + исполнитель (логист)
   - Назначение ответственного за доставку

4. ✅ **Товар в пути**
   - Требует: роль + исполнитель
   - Отслеживание транспортировки

5. ✅ **Товар у заказчика**
   - Переход без дополнительных полей
   - Фиксация факта доставки

6. **Товар поставлен. Ждём оплату** (выявлена валидация)
   - Требует: роль + исполнитель
   - **Обязательное поле**: Предполагаемая дата оплаты *
   - Сумма продажи заявки (автозаполняется)
   - Чекбокс выбора счета поставщика (СП1)
   - Валидация: "Поле Предполагаемая дата оплаты обязательно для заполнения"

7. **Товар не приняли** (альтернативная ветка от "Товар у заказчика")
   - Для обработки отказа заказчика
   - Требует документирования причин

8. **Оплата просрочена** (альтернативная ветка от "Товар поставлен")
   - Автоматический переход при просрочке предполагаемой даты оплаты
   - Для работы с дебиторской задолженностью

9. **Сделка оплачена. ЗАКРЫТА** (финальный этап)
   - Завершение жизненного цикла заявки
   - Фиксация оплаты и закрытие сделки

**Дополнительные этапы контракта (после закрытия всех заявок):**

- **Контракты на оплате** — контракт ожидает оплаты по завершенным заявкам
- **Контракты под вопросом** — проблемные контракты, требующие внимания
- **Завершен** — финальный этап контракта после получения всех оплат

**Валидационные правила:**

- **Этап 10 (Новые контракты в реализацию)**: дата заключения договора (обязательно)
- **Этапы заявок**: роль + исполнитель на всех промежуточных этапах
- **Этап "Товар поставлен. Ждём оплату"**: предполагаемая дата оплаты (обязательно)
- **Автозаполнение**: ранее выбранные роль/исполнитель переносятся на следующие этапы

**Финансовая аналитика в реальном времени:**

- Система отображает на канбане: сумму заявок, оплачено, долг, поставлено
- Процент завершения контракта
- Отслеживание дебиторской задолженности

### 3.3. Детальная структура меню и навигации

**Основное меню навигации (левая боковая панель):**

1. **Тендерный отдел (этапы 1-ой категории)**
   - URL: `/tender-department-first-category`
   - Канбан-доска с 10 этапами предконтрактной работы

2. **Реализация (этапы 2-ой категории)**
   - URL: `/tender-department-second-category`
   - Канбан-доска с этапами постконтрактной работы и заявками

3. **Календарь**
   - URL: `/calendar`
   - Планирование событий (месяц/неделя/день)

4. **Задачи**
   - URL: `/tasks`
   - Управление задачами сотрудников (Мои/Контроль/Все/Возврат/Склад)

5. **Тендеры**
   - URL: `/tenders`
   - Централизованный реестр всех тендеров

6. **Взыскание долгов**
   - URL: `/claims`
   - Работа с дебиторской задолженностью

7. **Логистика**
   - URL: `/logistics`
   - Управление доставками и перевозками

8. **Сотрудники**
   - URL: `/employees`
   - Управление пользователями и ролями

9. **Настройки**
   - URL: `/setting`
   - Конфигурация системы (подробнее ниже)

10. **Отчёты** (выпадающее меню, 8 пунктов)

11. **Справочники** (выпадающее меню, 6 пунктов)

**Подменю "Отчёты":**

1. **Тендерный отдел** (`/tender_department_report`)
   - Аналитика по работе тендерного отдела

2. **Реализация** (`/realization_report`)
   - Отчет по реализации контрактов

3. **Реестр оплат** (`/payment_registry`)
   - Журнал всех платежей

4. **Статистика** (`/statistics`)
   - Общая статистика по системе

5. **Показатели менеджера** (`/manager_performance`)
   - Персональная эффективность менеджеров

6. **Линейка обеспечения** (`/support_line`)
   - Контроль обеспечительных платежей

7. **Линейка деньги у заказчиков** (`/at_customer_line`)
   - Отслеживание денег на стороне заказчика

8. **Отчёт по выплатам** (`/payments-report`)
   - Детализация выплат сотрудникам

**Подменю "Справочники":**

1. **Типы** (`/types`)
   - Классификация типов тендеров

2. **Ответственные за этапы** (`/responsible-stages`)
   - Настройка ролей для каждого этапа

3. **Задачи по тендеру** (`/tender-subtask-types?type=1`)
   - Шаблоны задач для тендерных процессов

4. **Задачи по заявкам** (`/application-subtask-types?type=2`)
   - Шаблоны задач для работы с заявками

5. **Юр лица** (`/legal-entities`)
   - Справочник юридических лиц компании

6. **Поставщики** (`/contragents`)
   - База контрагентов и поставщиков

**Раздел "Настройки" (детальный функционал):**

**1. Налог:**
- Переключатель вкл/выкл
- Процент налога (по умолчанию: 15%)
- Вид налога (выпадающий список)
- Кнопка "Добавить" для создания записи

**2. Выплаты участникам:**
- Процент инвестора (по умолчанию: 5%)
- Процент победителя просчётчика (по умолчанию: 5%)
- Процент отдела реализации (по умолчанию: 5%)
- Процент управляющей компании (по умолчанию: 5%)

**3. Подтверждение оплаты:**
- Переключатель вкл/выкл (по умолчанию: включено)
- Выбор сотрудника, кому направлять задачи на подтверждение выплат

**Кнопка "Сохранить"** для применения всех настроек

**Ключевые наблюдения по меню:**

- **Логическая группировка**: разделы сгруппированы по функциональным блокам (работа с тендерами, аналитика, справочники, настройки)
- **Выпадающие меню**: используются только для отчётов и справочников, что уменьшает визуальную перегрузку
- **Иконки**: каждый пункт меню имеет иконку для быстрой идентификации
- **URL-структура**: понятная и логичная структура адресов
- **Настройки финансовой модели**: гибкая настройка распределения прибыли между участниками процесса
- **Контроль выплат**: встроенный механизм подтверждения для финансовой безопасности

### 3.4. Детальный анализ справочников

#### 1. Справочник "Типы" (`/types`)

**Назначение**: Классификация типов тендеров по нормативным актам

**Структура данных:**

- **ID** — уникальный идентификатор (автоинкремент)
- **Название** — наименование типа тендера
- **Действия** — редактирование / удаление

**Заполненные данные (5 типов):**

1. ФЗ-44 (ID: 532)
2. ФЗ-223 (ID: 533)
3. ФЗ-275 (ID: 534)
4. ПП-615 (ID: 535)
5. Коммерческие закупки (ID: 536)

**Функционал:**

- Поиск по названию
- Кнопка "Добавить" для создания нового типа
- Редактирование существующих записей (иконка карандаша)
- Удаление записей (иконка корзины)
- Сортировка по ID и Названию

**Применение**: Используется при создании тендера для указания нормативной базы

#### 2. Справочник "Ответственные за этапы" (`/responsible-stages`)

**Назначение**: Настройка ролевой модели для каждого этапа работы с тендерами и заявками

**Структура данных:**

- **№** — порядковый номер
- **Название** — название этапа с указанием категории
- **Уровень** — тип сущности (Тендер / Заявка / Контракт)
- **Роль ответственного сотрудника** — список ролей, которые могут быть назначены
- **Действия** — редактирование

**Категории (вкладки):**

- **Все** — полный список (40 записей)
- **Тендерный отдел** — этапы 1-ой категории
- **Реализация** — этапы 2-ой категории
- **По заявкам** — этапы работы с заявками
- **Архив** — архивные этапы
- **Взыскание долгов** — этапы работы с дебиторкой

**Примеры настроек (первые 10 из 40):**

1. Анализ и просчёт (Тендер) → Администратор Компании, Руководитель
2. Проверка (Тендер) → Руководитель, Администратор Компании
3. Подача (Тендер) → Администратор Компании, Менеджер
4. Подан. Рассмотрение заявки (Тендер) → Администратор Компании, Менеджер
5. Торги (Тендер) → Администратор Компании, Менеджер
6. Ждём итоги (Тендер) → Администратор Компании, Менеджер
7. Победа. Ждём договор (Тендер) → Администратор Компании, Менеджер
8. Заключение договора (Тендер) → Администратор Компании, Исполнитель
9. Договор подписан. Ждём заключения (Тендер) → Администратор Компании, Исполнитель
10. Договор не заключен (Тендер) → Администратор Компании, Исполнитель

**Функционал:**

- Поиск по названию этапа
- Фильтрация по категориям (вкладки)
- Редактирование ролей для каждого этапа
- Просмотр полного списка этапов (40 записей)

**Применение**: Определяет, какие роли могут быть назначены ответственными на каждом этапе

#### 3. Справочник "Задачи по тендеру" (`/tender-subtask-types?type=1`)

**Назначение**: Шаблоны задач, которые автоматически создаются при переходе тендера на определённые этапы

**Структура данных:**

- **ID** — уникальный идентификатор
- **Название** — описание задачи
- **Этапы** — на каких этапах создаётся задача
- **Кто может назначать** — роли, которые могут назначить задачу
- **Роль ответственного сотрудника** — кому назначается задача
- **Автозадача** — переключатель (вкл/выкл) для автоматического создания
- **Действия** — редактирование / удаление

**Количество**: 21 шаблон задач

**Примеры задач (первые 10):**

1. Напоминание "Отправить заявку на проверку" (Анализ и просчёт)
2. Доработка (Проверка)
3. Напоминание "Подача заявки" (Подача)
4. Обеспечить наличие средств на спецсчёте (Подача)
5. Оплата БГ (Подача) → назначается Риск менеджеру
6. Оплатить тариф (Подача) → назначается Риск менеджеру
7. Напоминание "Торги" (Торги)
8. Напоминание "Допуск к торгам" (Подан. Рассмотрение заявки)
9. Напоминание "Подведение итогов" (Ждём итоги)
10. Предварительное согласование товара (Победа. Ждём договор)

**Функционал:**

- Поиск по названию задачи
- Кнопка "Добавить" для создания нового шаблона
- Включение/отключение автозадач (переключатель)
- Редактирование шаблонов (иконка карандаша)
- Удаление шаблонов (иконка корзины)
- Связь задач с конкретными этапами
- Настройка ролей для назначения и исполнения

**Применение**: Автоматизация создания задач при переходе тендера между этапами

#### 4. Справочник "Задачи по заявкам" (`/application-subtask-types?type=2`)

**Назначение**: Шаблоны задач для работы с заявками в модуле "Реализация"

**Структура данных:**

- ID, Название, Этапы, Кто может назначать, Роль ответственного сотрудника, Автозадача, Действия
- Аналогична структуре "Задачи по тендеру"

**Состояние**: Справочник пустой (0 записей)

**Функционал:**

- Поиск
- Кнопка "Добавить"
- Возможность создания шаблонов задач для этапов заявок

**Применение**: Предназначен для автоматизации задач в модуле реализации (пока не заполнен)

#### 5. Справочник "Юр лица" (`/legal-entities`)

**Назначение**: База юридических лиц компании для оформления контрактов

**Структура данных:**

- **ID** — уникальный идентификатор
- **Название** — наименование юридического лица
- **Действия** — редактирование / удаление

**Состояние**: Справочник пустой (0 записей)

**Функционал:**

- Поиск по названию
- Кнопка "Добавить"
- Редактирование и удаление записей

**Применение**: Выбор юрлица при заключении договора на этапах 4-7 тендерного отдела

#### 6. Справочник "Поставщики" (`/contragents`)

**Назначение**: База контрагентов и поставщиков для работы с контрактами

**Структура данных:**

- **№** — порядковый номер
- **ФИО** — имя контактного лица
- **Должность** — должность контактного лица
- **Телефон** — контактный телефон
- **E-mail** — электронная почта
- **Сайт** — веб-сайт компании
- **Компания** — название организации-поставщика
- **Комментарий** — дополнительная информация
- **Действие** — редактирование / удаление

**Состояние**: Справочник пустой (0 записей)

**Функционал:**

- Поиск по всем полям
- Кнопка "Добавить"
- Расширенная карточка контрагента (8 полей)
- Редактирование и удаление записей
- Сортировка по №, ФИО, Должности

**Применение**: Используется при создании счетов поставщиков в модуле "Реализация"

### Общие выводы по справочникам

**Архитектура:**

- **Централизованное хранение**: все нормативные данные в одном месте
- **Переиспользование**: справочники используются во всех модулях CRM
- **Гибкость**: возможность добавления/редактирования любых записей
- **CRUD-операции**: полный набор операций для всех справочников

**Степень заполненности:**

- ✅ **Типы**: полностью заполнен (5 типов)
- ✅ **Ответственные за этапы**: полностью настроен (40 записей)
- ✅ **Задачи по тендеру**: активно используется (21 шаблон)
- ❌ **Задачи по заявкам**: не заполнен
- ❌ **Юр лица**: не заполнен
- ❌ **Поставщики**: не заполнен

**Ключевые особенности:**

1. **Ролевая модель**: четкое разделение ответственности через справочник "Ответственные за этапы"
2. **Автоматизация задач**: система автозадач на основе шаблонов
3. **Связь справочников**: данные из справочников используются в канбанах, карточках тендеров, формах
4. **Поиск и фильтрация**: доступны во всех справочниках
5. **Единый UI**: все справочники имеют похожий интерфейс (таблица + кнопка "Добавить")

**Рекомендации для разработки:**

- Реализовать справочники как отдельные таблицы с API
- Использовать нормализацию для связей (foreign keys)
- Добавить валидацию при удалении (проверка использования в тендерах)
- Реализовать импорт/экспорт справочников
- Добавить историю изменений для критичных справочников (Ответственные за этапы)

### Детальный анализ модальных окон справочников

#### Модалка "Типы" (добавление/редактирование)

**Поля формы:**

- **Наименование типа *** — текстовое поле (обязательное)

**Кнопки:**

- "закрыть" — отмена операции
- "сохранить" — сохранение записи

**Особенности:**

- Минималистичная форма с одним обязательным полем
- Идентичная логика для добавления и редактирования
- При редактировании поле предзаполнено текущим значением

#### Модалка "Ответственные за этапы" (редактирование)

**Заголовок:** "Выбор ответственного за этап [Название этапа]"

**Поля формы:**

- **Наименование** — текстовое поле (disabled, только чтение)
- **Уровень** — текстовое поле (disabled, только чтение, значения: Тендер/Заявка/Контракт)
- **Роль ответственного сотрудника** — группа чекбоксов:
  - ☐ Тот кто переводит этап
  - ☐ Ответственный менеджер
  - ☐ Ответственный тендерный специалист
  - ☐ Ответственный исполнитель
  - ☑ Сотрудники с этими ролями (чекбокс активирует дополнительные поля)
- **Роль ответственного сотрудника *** — мультиселект (с тегами, кнопка "Clear all")
- **Сотрудники** — мультиселект для выбора конкретных сотрудников

**Кнопки:**

- "закрыть" — отмена
- "сохранить" — сохранение

**Особенности:**

- Сложная логика с условными полями (чекбокс активирует мультиселекты)
- Мультиселект с визуализацией тегов и возможностью очистки всех значений
- Название и уровень этапа нельзя редактировать (жестко привязаны к системе)
- Возможность назначения нескольких ролей одновременно

#### Модалка "Задачи по тендеру" (добавление)

**Заголовок:** "Добавить задачу"

**Поля формы:**

1. **Наименование *** — текстовое поле (обязательное)

2. **Категория этапа** — выпадающий список (combobox)

3. **Этапы** — мультиселект (можно выбрать несколько этапов)

4. **Кто может назначать** — мультиселект ролей

5. **Роль ответственного сотрудника** — группа чекбоксов:
   - ☐ Тот кто создает задачу
   - ☐ Ответственный менеджер
   - ☐ Ответственный тендерный специалист
   - ☐ Ответственный исполнитель
   - ☐ Сотрудники с этими ролями

6. **Роль ответственного сотрудника *** — мультиселект (активируется чекбоксом)

7. **Сотрудники** — мультиселект для выбора конкретных сотрудников

8. **Автозадача** — переключатель (switch) для автоматического создания задачи

**Разделитель** (separator)

**Кнопки:**

- "закрыть" — отмена
- "сохранить" — создание задачи

**Особенности:**

- Наиболее сложная форма среди всех справочников
- Поддержка множественного выбора этапов (одна задача на несколько этапов)
- Переключатель "Автозадача" — ключевая функция автоматизации
- Условная логика: чекбоксы определяют видимость мультиселектов
- Разделитель перед кнопками для визуального отделения контента

#### Модалка "Юр лица" (добавление)

**Заголовок:** "Добавление Юр лица"

**Поля формы:**

- **Наименование Юр лица *** — текстовое поле (обязательное)

**Кнопки:**

- "закрыть" — отмена
- "сохранить" — сохранение

**Особенности:**

- Простейшая форма, аналогична "Типы"
- Единственное обязательное поле
- Минималистичный интерфейс

#### Модалка "Поставщики" (добавление)

**Заголовок:** "Добавление поставщика"

**Поля формы:**

1. **ФИО** — текстовое поле (опционально)

2. **Должность** — текстовое поле (опционально)

3. **Телефон *** — текстовое поле (обязательное!)

4. **E-mail** — текстовое поле (опционально)

5. **Сайт** — текстовое поле (опционально)

6. **Компания** — текстовое поле (опционально)

7. **Комментарий** — заголовок + текстовое поле (многострочное, опционально)

**Кнопки:**

- "закрыть" — отмена
- "сохранить" — сохранение

**Особенности:**

- Самая объемная форма среди простых справочников (7 полей)
- Обязательное поле — только "Телефон"
- Поле "Комментарий" имеет отдельный заголовок над полем
- Расширенная карточка контрагента с контактной информацией
- Возможность хранения как физических лиц (ФИО + должность), так и организаций (Компания)

### Общие UX-паттерны модальных окон

**Единообразие интерфейса:**

- Все модалки имеют заголовок с кнопкой закрытия (×) справа
- Стандартные кнопки "закрыть" и "сохранить" внизу формы
- Обязательные поля помечены звездочкой (*)
- Группировка полей с помощью `<group>` компонентов

**Типы элементов форм:**

- **Текстовые поля** — для простого ввода (типы, юр лица, поставщики)
- **Combobox (выпадающий список)** — для выбора из предустановленных опций
- **Мультиселект** — для выбора нескольких значений с визуализацией тегов
- **Чекбоксы** — для включения/выключения опций и активации условных полей
- **Switch (переключатель)** — для бинарных состояний (автозадача вкл/выкл)
- **Textarea** — для многострочного текста (комментарии)

**Валидация:**

- Клиентская валидация обязательных полей (блокировка кнопки "сохранить")
- Визуальная индикация обязательных полей (звездочка)
- Автофокус на первом поле при открытии модалки

**Закрытие модалок:**

- Кнопка "закрыть"
- Иконка × в заголовке
- Клавиша Escape
- Клик вне модалки (вероятно)

**Адаптивность:**

- Модалки центрированы на экране
- Скролл при переполнении контента
- Фиксированная ширина для консистентности

**Ключевые находки:**

1. **Прогрессивное усложнение**: от простых форм (1 поле) до сложных (множественный выбор + условная логика)
2. **Переиспользование компонентов**: мультиселекты, чекбоксы используются в разных справочниках
3. **Условная логика**: чекбоксы активируют/деактивируют дополнительные поля
4. **Автоматизация**: переключатель "Автозадача" — уникальный функционал для задач
5. **Гибкость ролей**: система поддерживает назначение нескольких ролей одновременно

### 3.5. Детальный анализ отчетов

CRM предоставляет 8 специализированных отчетов для аналитики и контроля бизнес-процессов.

#### 1. Отчет "Тендерный отдел" (`/tender_department_report`)

**Назначение**: Аналитика по этапам работы тендерного отдела (1-я категория этапов)

**Структура:**

- **Вкладки**: Сегодня | Период | Текущая ситуация
- **Фильтры**: 
  - Ответственный менеджер
  - Ответственный тендерный специалист
  - Ответственный за реализацию тендера
- **Кнопка**: "Сбросить" — очистка всех фильтров

**Таблица данных (3 колонки):**

- **Этап** — название этапа с кнопкой раскрытия деталей
- **Количество** — количество тендеров на этапе
- **Сумма, руб.** — общая сумма тендеров на этапе

**Этапы (10 строк):**

1. Добавлено в систему
2. Не участвуем
3. Пришло на проверку
4. Не прошло проверку
5. Пришло на подачу
6. Не подано
7. Подано
8. Выиграли
9. Проиграли
10. Заключен договор

**Особенности:**

- Кнопка раскрытия для просмотра списка тендеров на этапе
- Группировка по статусам (позитивные/негативные исходы)
- Временные фильтры для анализа динамики

#### 2. Отчет "Реализация" (`/realization_report`)

**Назначение**: Аналитика по этапам реализации контрактов (2-я категория этапов)

**Структура:**

- **Вкладки**: Сегодня | Период | Текущая ситуация
- **Фильтры**: те же 3 фильтра, что в "Тендерном отделе"

**Три раздела с таблицами:**

**1. Контракты** (этапы контрактов)

- Новые контракты в реализацию
- Контракты «Ждём заявки»
- Контракты в поставке
- Контракты на оплате
- Контракты под вопросом
- Завершен

**2. Заявки** (этапы заявок/сделок)

- 9 этапов жизненного цикла заявки (от создания до оплаты)

**3. Счета поставщиков**

- Отслеживание счетов от контрагентов

**Особенности:**

- Трехуровневая структура: Контракт → Заявки → Счета
- Агрегация данных по всем уровням
- Единый интерфейс фильтрации для всех разделов

#### 3. Отчет "Реестр оплат" (`/payment_registry`)

**Назначение**: Журнал выставленных и оплаченных счетов

**Структура:**

- **Вкладки**: Выставленные счета | Оплаченные счета
- **Кнопка экспорта**: "Экспорт в Excel" (с иконкой)
- **Фильтры**: кнопка "Показать фильтры" (скрытые по умолчанию)
- **Поиск**: текстовое поле "Введите запрос"

**Таблица (6 колонок):**

- **№** — порядковый номер счета
- **Номер закупки** — связь с тендером
- **Оплата** — статус оплаты (сортировка)
- **Сумма** — сумма счета
- **Дата и время создания** — timestamp (сортировка)
- **Юр.лицо** — юридическое лицо

**Особенности:**

- Экспорт в Excel для бухгалтерии
- Разделение выставленных и оплаченных
- Полнотекстовый поиск по счетам

#### 4. Отчет "Статистика" (`/statistics`)

**Назначение**: Общая статистика по системе (отчет был недоступен для детального анализа)

**Предполагаемое содержание:**

- Сводные показатели по тендерам
- Динамика побед/поражений
- Финансовая сводка

#### 5. Отчет "Показатели менеджера" (`/manager_performance`)

**Назначение**: Персональная эффективность менеджеров

**Структура:**

- **Вкладки**: Сегодня | Период | За все время
- **Фильтр**: Ответственный менеджер (выбор конкретного сотрудника)

**Три раздела:**

**1. ЭФФЕКТИВНОСТЬ**

Таблица с колонками:
- Параметры эффективности
- Значение (текущий показатель)
- Период (мес.) (средний показатель)

Метрики:
- Количество просчётов (отдано на проверку)
- Из них «Подано»
- Из них «Забраковано»
- Соотношение «Подано»/«Просчитано» (%)
- Выиграно тендеров
- Соотношение «Выиграно»/«Подано» (%)

**2. ФИНАНСЫ**

Метрики:
- Заявок в оплате (количество и сумма)
- Из них в просрочке
- Прибыль по ним (ГРЯЗНАЯ)
- Заработок менеджера по ним

**3. ТЕНДЕРНЫЙ ОТДЕЛ (этапы 1 категории)**

- Распределение тендеров менеджера по этапам

**4. РЕАЛИЗАЦИЯ (этапы 2 категории)**

- Распределение заявок менеджера по этапам реализации

**Особенности:**

- KPI-ориентированный подход
- Процентные соотношения для оценки конверсии
- Финансовые показатели в реальном времени
- Разделение эффективности на работу и результат

#### 6. Отчет "Линейка обеспечения" (`/support_line`)

**Назначение**: Контроль обеспечительных платежей (банковские гарантии, спецсчета)

**Структура:**

- **Кнопка**: "Добавить" — добавление записи об обеспечении
- **Поиск**: текстовое поле
- **Фильтры**: 
  - Бухгалтер
  - Добавил (кто создал запись)
  - Компания
  - Сумма от/до
  - Статус
  - Период (календарь с выбором дат)

**Календарь:**

- Визуальный выбор периода
- Кнопки навигации (предыдущий/следующий месяц)
- Кнопка "Текущий месяц"

**Таблица (8 колонок):**

- Статус
- Бухгалтер
- Юр. лицо
- Дата
- Сумма руб.
- Добавил
- Время выполнения (затраченное)
- Действие (редактирование/удаление)

**Особенности:**

- Управление финансовыми обязательствами
- Календарная навигация для временного анализа
- Трекинг времени обработки
- Ручное добавление записей

#### 7. Отчет "Линейка деньги у заказчиков" (`/at_customer_line`)

**Назначение**: Отслеживание денег на стороне заказчика (дебиторская задолженность)

**Структура:**

Идентична "Линейке обеспечения":
- Те же фильтры
- Тот же календарь
- Та же структура таблицы (8 колонок)

**Особенности:**

- Контроль дебиторской задолженности
- Аналогичный UX с "Линейкой обеспечения"
- Переиспользование компонентов интерфейса

#### 8. Отчет "Отчёт по выплатам" (`/payments-report`)

**Назначение**: Детализация выплат сотрудникам (расчет бонусов и комиссий)

**Структура:**

- **Поиск**: текстовое поле в шапке
- **Фильтры** (11 полей):
  - Ответственный менеджер
  - Ответственный подающий
  - Ответственный реализатор
  - Сумма от/до
  - Продажа от/до
  - Цена контракта от/до
  - НМЦК от/до
  - Дата оплаты (календарь)
  - Статус оплаты

**Таблица (21 колонка!):**

1. № тендера
2. Номер заявки
3. Наименование товара
4. Кто выиграл (менеджер)
5. Тендерный специалист (подающий)
6. Ответственный за реализацию (реализатор)
7. От какой компании выиграли
8. НМЦК, руб.
9. Цена контракта, руб.
10. Продажа, руб.
11. Дата оплаты
12. Все расходы, руб.
13. Прибыль до налогов, руб.
14. Налог, руб.
15. Итого ЧИСТЫМИ, руб.
16. % победителя просчётчика, руб.
17. Коэффициент списания
18. ИТОГО РЕЗУЛЬТАТ, руб.
19. Статус оплаты бонуса просчётчику
20. % отдела реализации, руб.
21. Статус оплаты бонуса отделу реализации

**Данные (пример из 601 записи):**

- Тендер 32312315116, заявка 1: прибыль 1 583 893 ₽
- Тендер 0373200307323000120: убыток -120 000 ₽
- Тендер 100069333123100149: прибыль 15 304 ₽, налог 696 ₽

**Особенности:**

- Самая детализированная таблица в системе (21 колонка)
- Полный финансовый расчет с прибылью, налогами, бонусами
- Показывает всю финансовую цепочку: НМЦК → Контракт → Продажа → Расходы → Налог → Чистая прибыль → Бонусы
- Статусы оплаты бонусов для контроля выплат
- Коэффициент списания для корректировки расчетов
- 601 запись — большой объем данных для анализа

### Общие выводы по отчетам

**Архитектура отчетов:**

- **Иерархия данных**: от общего к частному (отдел → менеджер → тендер → заявка)
- **Временные срезы**: все отчеты поддерживают фильтры "Сегодня", "Период", "За все время"
- **Переиспользование фильтров**: одинаковые фильтры в разных отчетах
- **Экспорт данных**: поддержка Excel для интеграции с внешними системами

**Типы отчетов:**

1. **Агрегирующие** (Тендерный отдел, Реализация) — группировка по этапам
2. **Детализирующие** (Отчёт по выплатам) — подробная информация по каждой записи
3. **Журналы** (Реестр оплат, Линейка обеспечения) — хронология событий
4. **KPI-отчеты** (Показатели менеджера) — метрики эффективности

**Функциональные возможности:**

- **Сортировка**: по всем колонкам с индикатором направления
- **Поиск**: полнотекстовый и через фильтры
- **Кнопка "Сбросить"**: быстрая очистка всех фильтров
- **Календарь**: визуальный выбор периода
- **Раскрытие деталей**: drill-down по этапам
- **Экспорт**: Excel для бухгалтерии
- **Пагинация**: 10-50 строк на страницу

**Ключевые особенности:**

1. **Финансовая прозрачность**: полная детализация от НМЦК до чистой прибыли и бонусов
2. **Ролевая аналитика**: отчеты для разных ролей (менеджер, тендерный специалист, реализатор, бухгалтер)
3. **Контроль обязательств**: отдельные отчеты для обеспечения и дебиторки
4. **Трекинг времени**: "Время выполнения (затраченное)" в финансовых отчетах
5. **Статусы оплат**: контроль выплат бонусов с подтверждением

**Недостатки:**

- Перегруженность колонками (21 колонка в "Отчёте по выплатам")
- Отсутствие визуализации (графики, диаграммы)
- Нет сводных дашбордов
- Календарь занимает много места

**Рекомендации для разработки:**

- Реализовать визуализацию данных (Chart.js, Recharts)
- Добавить настройку видимости колонок
- Создать сводный дашборд с ключевыми метриками
- Использовать progressive disclosure для детальных данных
- Добавить экспорт в PDF для отчетов
- Реализовать сохранение настроек фильтров

### 3.6. Детальный анализ страницы "Сотрудники"

#### Структура страницы (`/employees`)

**Заголовок:**

- **Название**: "Сотрудники"
- **Кнопка**: "добавить пользователя" — открывает модальное окно

**Вкладки (2 категории):**

1. **Действующие** — активные сотрудники (по умолчанию)
2. **Новые (со страницы регистрации)** — заявки на регистрацию

**Фильтры:**

- **Заголовок**: "Фильтры"
- **Кнопка**: "Сбросить" — очистка всех фильтров
- **Должность** — выпадающий список для фильтрации по роли
- **Поиск**: "Введите запрос" — полнотекстовый поиск

**Таблица сотрудников (6 колонок):**

1. **Чекбокс** — массовый выбор
2. **Сотрудник** — ФИО с аватаром (сортировка)
3. **Комментарий** — дополнительная информация (сортировка)
4. **Контакты** — телефон, email, телеграм
5. **Должность** — роли сотрудника (сортировка)
6. **Статус** — активен/неактивен (сортировка)

**Состояние:**

- Таблица пустая ("Ничего не найдено")
- Пагинация: 10 строк на страницу

#### Модальное окно "Новый пользователь"

**Заголовок:**

- "Новый пользователь"
- Кнопка закрытия (×)

**Структура формы:**

**Раздел 1: Фото профиля**

- **Аватар**: круглая иконка пользователя
- **Кнопка**: "Изменить фото" — загрузка изображения
- **Иконка удаления** (корзина)

**Раздел 2: Персональные данные**

1. **ФИО *** — текстовое поле (обязательное)

2. **Телефон *** — текстовое поле с кнопкой "добавить"
   - Возможность добавления нескольких номеров телефонов

3. **Email *** — текстовое поле (обязательное)
   - Предзаполнено: `corvetik19@gmail.com`

4. **Телеграмм** — текстовое поле (опционально)
   - Для связи через мессенджер

5. **Выберите значение** — мультиселект должностей/ролей
   - **Опция**: "Выбрать все" (с чекбоксом)
   - **Разделитель** (separator)
   - **9 ролей** (каждая с чекбоксом):
     1. Руководитель
     2. Менеджер
     3. Риск менеджер
     4. Тендерный специалист
     5. Исполнитель
     6. Бухгалтер
     7. Логист
     8. Юрист
     9. Инвестор

6. **Дата рождения** — календарь (кнопка выбора даты)

**Раздел 3: Данные работы**

1. **Логин *** — текстовое поле (обязательное)
   - Для входа в систему

2. **Пароль *** — текстовое поле (обязательное)
   - Предзаполнено: `corvetik19@gmail.com`

3. **Подтверждение пароля *** — текстовое поле (обязательное)
   - Валидация совпадения с паролем

4. **Показать пароль** — чекбокс
   - Переключение видимости паролей

**Кнопка сохранения:**

- "добавить пользователя" — создание нового сотрудника

### Ключевые особенности страницы "Сотрудники"

**Ролевая система:**

- **Мультиролевость**: сотрудник может иметь несколько ролей одновременно
- **9 ролей**: полный набор для всех участников бизнес-процесса
- **Опция "Выбрать все"**: массовое назначение всех ролей
- **Чекбоксы**: визуальная индикация выбранных ролей

**Множественные контакты:**

- **Несколько телефонов**: кнопка "добавить" для добавления номеров
- **Email**: основной канал связи
- **Телеграм**: дополнительный мессенджер

**Безопасность:**

- **Логин/пароль**: стандартная аутентификация
- **Подтверждение пароля**: защита от опечаток
- **Показать пароль**: UX для проверки ввода
- **Валидация**: автоматическая проверка совпадения паролей

**Управление пользователями:**

- **Две категории**: действующие и новые (заявки на регистрацию)
- **Модерация**: возможность одобрения заявок со страницы регистрации
- **Фильтрация**: по должности и полнотекстовый поиск
- **Массовые операции**: чекбоксы для группового выбора

**UX-решения:**

- **Фото профиля**: персонализация интерфейса
- **Группировка полей**: логические разделы (Персональные данные, Данные работы)
- **Автозаполнение email**: удобство для тестирования/разработки
- **Календарь**: для выбора даты рождения (не обязательное поле)

**Связь с системой:**

- Роли из модалки используются в:
  - Справочнике "Ответственные за этапы"
  - Справочнике "Задачи по тендеру"
  - Фильтрах отчетов (менеджер, тендерный специалист, реализатор)
  - Канбан-досках (назначение ответственных)

**Недостатки:**

- Нет поля "Комментарий" в модалке (есть в таблице)
- Предзаполнение email и пароля одинаковыми значениями (тестовые данные)
- Нет возможности редактирования (только просмотр таблицы)
- Отсутствие функции деактивации/увольнения сотрудника в UI

**Рекомендации для разработки:**

- Добавить поле "Комментарий" в модалку
- Реализовать валидацию email (формат)
- Добавить генератор паролей
- Реализовать редактирование сотрудников (модалка или отдельная страница)
- Добавить поле "Статус" (активен/уволен/отпуск)
- Реализовать функцию деактивации учетной записи
- Добавить историю изменений ролей
- Реализовать модерацию заявок со страницы регистрации (вкладка "Новые")

### 3.7. Детальный анализ страницы "Логистика"

#### Структура страницы (`/logistics`)

**Назначение:** Управление доставкой товаров от поставщика до заказчика

**Заголовок:**

- **Название**: "Логистика"
- **Нет кнопки добавления** — записи создаются автоматически из заявок модуля "Реализация"

**Панель фильтров:**

**Кнопки управления:**

- "Свернуть фильтры" — скрытие панели фильтров
- "Сбросить фильтры" — очистка всех фильтров

**Фильтры (5 полей + поиск):**

1. **Реализатор** — выпадающий список (combobox)
   - Фильтрация по ответственному за реализацию

2. **Логист** — выпадающий список (combobox)
   - Фильтрация по назначенному логисту

3. **Дата** — календарь (кнопка выбора даты)
   - Фильтрация по дате доставки

4. **Цена от** — текстовое поле
   - Минимальная стоимость доставки

5. **Цена до** — текстовое поле
   - Максимальная стоимость доставки

6. **Поиск** — текстовое поле + кнопка "найти"
   - Полнотекстовый поиск по всем полям

**Таблица логистики (11 колонок):**

1. **№ тендера, заявки и СП** — номер тендера и заявки
   - Связь с модулем "Реализация"

2. **Реализатор** — ответственный за реализацию
   - Из справочника "Сотрудники" (роль "Исполнитель")

3. **Логист** — ответственный за доставку
   - Из справочника "Сотрудники" (роль "Логист")

4. **Дата** — дата доставки
   - Планируемая или фактическая дата

5. **Погрузка (название, адрес, телефон, № счёта)** — точка отгрузки (сортировка)
   - Адрес поставщика
   - Контактные данные
   - Номер счета поставщика

6. **Выгрузка (название, адрес, телефон)** — точка доставки (сортировка)
   - Адрес заказчика
   - Контактные данные

7. **Масса/кол-во груза** — вес или количество (сортировка)
   - Единицы измерения: кг, шт, м³

8. **Объем/характер груза** — тип и объем (сортировка)
   - Описание товара
   - Особые условия (хрупкое, негабарит и т.д.)

9. **Объем/характер груза** — дублирующая колонка (сортировка)
   - Возможно, ошибка в структуре таблицы

10. **Экспедитор/водитель** — ответственный за перевозку (сортировка)
    - ФИО водителя
    - Номер автомобиля

11. **Стоимость, руб.** — стоимость доставки (сортировка)
    - Расходы на логистику

**Состояние:**

- Таблица пустая ("Ничего не найдено")
- Пагинация: 10 строк на страницу

### Ключевые особенности страницы "Логистика"

**Интеграция с модулем "Реализация":**

- **Автоматическое создание**: записи логистики создаются из заявок на этапе "Логистика"
- **Связь по номеру**: колонка "№ тендера, заявки и СП" — связь с тендером и заявкой
- **Назначение логиста**: роль "Логист" из справочника "Сотрудники"

**Детализация маршрута:**

- **Две точки**: погрузка (от поставщика) и выгрузка (к заказчику)
- **Полные контакты**: название, адрес, телефон для обеих точек
- **Номер счета**: привязка к счету поставщика

**Характеристики груза:**

- **Масса/количество**: для расчета стоимости перевозки
- **Объем/характер**: для подбора транспорта
- **Особые условия**: хрупкое, негабарит, температурный режим

**Ответственные лица:**

- **Реализатор**: контролирует выполнение заявки
- **Логист**: организует доставку
- **Экспедитор/водитель**: выполняет перевозку

**Финансы:**

- **Стоимость доставки**: учитывается в общих расходах по заявке
- **Связь с отчетами**: данные попадают в "Отчёт по выплатам" (колонка "Все расходы")

**UX-решения:**

- **Сворачиваемые фильтры**: экономия пространства экрана
- **Диапазон цен**: фильтрация "от-до" для стоимости
- **Календарь**: удобный выбор даты доставки
- **Сортировка**: по всем колонкам с данными

**Недостатки:**

- **Дублирующая колонка**: "Объем/характер груза" повторяется дважды (вероятно, ошибка)
- **Нет статусов**: не видно состояния доставки (в пути, доставлено, задержка)
- **Нет кнопки добавления**: невозможно создать запись логистики вне заявки
- **Нет документов**: отсутствует возможность прикрепить ТТН, накладные
- **Нет трекинга**: нет отслеживания местоположения груза

**Рекомендации для разработки:**

- Убрать дублирующую колонку "Объем/характер груза"
- Добавить колонку "Статус" (запланировано, в пути, доставлено, задержка)
- Реализовать загрузку документов (ТТН, накладные, фото)
- Добавить поле "Комментарий" для особых указаний
- Реализовать трекинг доставки (интеграция с GPS)
- Добавить историю изменений статуса
- Реализовать уведомления логисту при создании записи
- Добавить возможность ручного создания записи (не только из заявок)
- Реализовать печать ТТН прямо из системы
- Добавить карту с маршрутом (Google Maps / Yandex Maps)

**Связь с другими модулями:**

- **Реализация**: заявки → автоматическое создание записей логистики
- **Сотрудники**: роли "Логист", "Исполнитель" (реализатор)
- **Поставщики**: адрес и контакты для погрузки
- **Отчёт по выплатам**: стоимость доставки в расходах

**Бизнес-процесс:**

1. Заявка переходит на этап "Логистика" (модуль "Реализация")
2. Автоматически создается запись в таблице "Логистика"
3. Логисту назначается задача организовать доставку
4. Логист заполняет детали: адреса, дату, экспедитора, стоимость
5. Груз доставляется заказчику
6. Стоимость доставки учитывается в общих расходах заявки
7. Запись остается в таблице для архива и аналитики

### 3.8. Детальный анализ страницы "Взыскание долгов"

#### Структура страницы (`/claims`)

**Назначение:** Управление дебиторской задолженностью и судебными процессами по неоплаченным заявкам

**Заголовок:**

- **Кнопка**: меню (гамбургер)
- **Название**: "Взыскание долгов"
- **Статус**: индикатор

**Вкладки (7 этапов жизненного цикла претензии):**

1. **Новые** — только что созданные претензии (по умолчанию)
2. **Не оплачено (претензии)** — претензионная работа
3. **Реестр заседаний (суды)** — судебные процессы
4. **Исполнительный лист (результат)** — получен исполнительный лист
5. **Отработано (подвисло)** — завершенные безрезультатно
6. **Оплачено (завершено)** — долг погашен
7. **Все записи о претензиях** — полный список

**Панель управления:**

- **Кнопка**: "Добавить претензию" — открывает модальное окно
- **Поиск**: текстовое поле с иконкой поиска
- **Фильтры**: кнопка "Показать фильтры" (скрытые по умолчанию)
- **Кнопка**: "Сбросить" — очистка фильтров

**Счетчик:** "Всего: 0 претензий"

**Таблица претензий (9 колонок):**

1. **ID** — уникальный идентификатор претензии (сортировка по убыванию)
2. **№ Тендера** — номер тендера (сортировка)
   - Связь с модулем "Тендерный отдел"
3. **№ Заявки** — номер заявки (сортировка)
   - Связь с модулем "Реализация"
4. **Истец** — организация-истец (сортировка)
   - Из справочника "Юр лица"
5. **Ответчик** — организация-должник (сортировка)
   - Заказчик, не оплативший заявку
6. **Основной долг (сумма заявки)** — сумма задолженности (сортировка)
   - В рублях
7. **Номер договора** — номер контракта
8. **Комментарий** — дополнительная информация
9. **Действие** — кнопки редактирования/удаления

**Состояние:**

- Таблица пустая ("Ничего не найдено")
- Пагинация: 10 строк на страницу

#### Модальное окно "Добавление претензии"

**Заголовок:**

- "Добавление претензии"
- Кнопка закрытия (×)

**Поля формы (6 полей):**

1. **№ Тендера** — выпадающий список (combobox)
   - Выбор из списка существующих тендеров
   - Обязательное поле

2. **№ Заявки** — выпадающий список (combobox, disabled)
   - Заполняется автоматически после выбора тендера
   - Список заявок выбранного тендера

3. **Истец** — выпадающий список (combobox, disabled)
   - Заполняется автоматически из данных заявки
   - Юридическое лицо компании

4. **Ответчик** — выпадающий список (combobox, disabled)
   - Заполняется автоматически из данных заявки
   - Организация-заказчик

5. **Юрист** — выпадающий список (combobox)
   - Выбор из справочника "Сотрудники" (роль "Юрист")
   - Ответственный за ведение дела

6. **Основной долг (сумма заявки)** — числовое поле (spinbutton)
   - Сумма задолженности
   - Вероятно, предзаполняется из заявки

**Кнопки:**

- "Закрыть" — отмена
- "Добавить претензию" — создание записи

### Ключевые особенности страницы "Взыскание долгов"

**7-этапный workflow:**

1. **Новые** — создание претензии
2. **Не оплачено (претензии)** — претензионная работа (письма, звонки)
3. **Реестр заседаний (суды)** — подача иска, судебные заседания
4. **Исполнительный лист (результат)** — получение исполнительного листа
5. **Отработано (подвисло)** — безнадежные долги
6. **Оплачено (завершено)** — успешное взыскание
7. **Все записи** — архив всех претензий

**Интеграция с другими модулями:**

- **Тендерный отдел**: выбор тендера по номеру
- **Реализация**: связь с заявкой (№ Заявки)
- **Юр лица**: автозаполнение истца
- **Сотрудники**: назначение юриста (роль "Юрист")
- **Отчёт по выплатам**: учет взысканных сумм

**Автоматическое заполнение:**

- **Истец**: из данных заявки (юр лицо компании)
- **Ответчик**: из данных заявки (заказчик)
- **Сумма долга**: из суммы заявки (вероятно)
- **Номер договора**: из контракта (вероятно)

**Каскадная зависимость полей:**

1. Выбирается **№ Тендера** → активируется поле **№ Заявки**
2. Выбирается **№ Заявки** → автозаполняются **Истец**, **Ответчик**, **Сумма**
3. Выбирается **Юрист** → создается претензия

**Бизнес-процесс:**

1. Заявка на этапе "Оплата просрочена" (модуль "Реализация")
2. Юрист создает претензию через кнопку "Добавить претензию"
3. Система автоматически подтягивает данные из заявки
4. Юрист назначается ответственным
5. Претензия проходит этапы: письма → суд → исполнительный лист
6. Долг взыскивается или списывается
7. Запись переходит в статус "Оплачено" или "Отработано"

**UX-решения:**

- **Вкладки-этапы**: визуализация жизненного цикла претензии
- **Счетчик**: "Всего: X претензий" на каждой вкладке
- **Автозаполнение**: минимизация ручного ввода
- **Disabled-поля**: защита от ошибок заполнения
- **Каскадная зависимость**: логичный порядок заполнения

**Недостатки:**

- **Нет дат**: отсутствуют даты создания, суда, погашения
- **Нет документов**: нет возможности прикрепить претензию, иск, решение суда
- **Нет статусов**: непонятно, на каком подэтапе находится претензия
- **Нет истории**: не видно истории переходов между этапами
- **Нет расчета**: не видно пени, процентов, судебных издержек
- **Нет напоминаний**: нет уведомлений о сроках подачи иска, заседаниях

**Рекомендации для разработки:**

- Добавить колонки с датами (создания, суда, погашения)
- Реализовать загрузку документов (претензия, иск, решение, исполнительный лист)
- Добавить подстатусы внутри этапов
- Реализовать историю переходов между этапами
- Добавить расчет пени и процентов по ст. 395 ГК РФ
- Реализовать календарь заседаний с напоминаниями
- Добавить шаблоны документов (претензия, иск)
- Реализовать интеграцию с системой "Правосудие" (электронная подача)
- Добавить учет судебных издержек
- Реализовать отчет по эффективности взыскания (% успеха)

**Связь с ролями:**

- **Юрист** (из справочника "Сотрудники") — ведет дело
- **Бухгалтер** — отслеживает поступление оплаты
- **Руководитель** — принимает решение о списании

**Финансовый учет:**

- Взысканная сумма → уменьшение дебиторской задолженности
- Судебные издержки → расходы компании
- Списанный долг → убытки компании

**Юридические аспекты:**

- Претензионный порядок (обязателен по ГК РФ)
- Судебный порядок (при отказе от добровольной оплаты)
- Исполнительное производство (через ФССП)
- Сроки исковой давности (3 года по ГК РФ)

### 3.9. Детальный анализ страницы "Тендеры"

#### Структура страницы (`/tenders`)

**Назначение:** Табличное представление всех тендеров в системе с расширенными фильтрами и поиском

**Заголовок:**

- **Кнопка**: меню (гамбургер)
- **Название**: "Тендеры"
- **Статус**: индикатор

**Вкладки (3 категории):**

1. **В работе** — активные тендеры (по умолчанию)
2. **Архив** — завершенные тендеры
3. **Все** — полный список без фильтров

**Панель управления:**

- **Кнопка**: "Показать фильтры" — раскрытие панели фильтров
- **Кнопка**: "Сбросить" — очистка всех фильтров
- **9 иконок фильтров**: быстрый доступ к основным фильтрам (󰍝 󰍝 󰍝 󰍝 󰍝 󰍝 󰃭 󰃭 󰃭)
- **Кнопка**: "Добавить" — открывает модальное окно

**Счетчики (2 показателя):**

- "Всего: 2 контракта"
- "На общую сумму: 3 304 333.17 ₽"

**Поиск и настройки:**

- **Поиск**: текстовое поле + кнопка "найти"
- **Кнопка**: "Настройки таблицы" — управление видимостью колонок

**Таблица тендеров (26 колонок!):**

1. **№** — порядковый номер (сортировка)
2. **Имя проекта** — название проекта (сортировка)
3. **Этап** — текущий этап тендера (сортировка)
4. **Предмет закупки** — описание товара/услуги (сортировка)
5. **Начальная цена контракта (руб.)** — НМЦК
6. **Номер закупки** — ссылка на zakupki.gov.ru
7. **Кем выиграли** — юридическое лицо
8. **Способ определения** — метод закупки
9. **Ответственный менеджер** — из справочника "Сотрудники"
10. **Ответственный тендерный специалист** — из справочника "Сотрудники"
11. **Инвестор** — из справочника "Сотрудники"
12. **Ответственный за реализацию тендера** — из справочника "Сотрудники"
13. **Заказчик** — организация-заказчик
14. **Город** — локация
15. **Тип** — из справочника "Типы"
16. **Обеспечение контракта** — сумма гарантии
17. **Обеспечение заявки** — сумма гарантии
18. **Площадка** — электронная площадка
19. **Дата окончания подачи заявки** — дедлайн (сортировка)
20. **Цена для торгов** — предложенная цена (сортировка)
21. **Комментарий** — дополнительная информация (ссылка)
22. **Дата рассмотрения заявки** — дата проверки (сортировка)
23. **Дата подведения итогов** — дата объявления результатов (сортировка)
24. **Дата проведения аукциона** — дата торгов (сортировка)
25. **Действие** — кнопки редактирования/удаления
26. **[пустая колонка]** — placeholder

**Данные (2 реальных тендера):**

1. **№ 32515378859**: "Поставка передвижного ком...", этап "Контракты в поставке (есть открытые сделки)", 1 720 439.67 ₽
2. **№ 32312315116**: "СИП (самонесущий изолиров...)", этап "Анализ и просчёт", 1 583 893.50 ₽

**Состояние:**

- Пагинация: 10 строк на страницу
- 2 записи в базе

#### Модальное окно "Добавить закупку"

**Заголовок:**

- "Добавить закупку"
- Кнопка закрытия (×)

**Первый шаг (поиск в базе госзакупок):**

1. **Текстовое поле**: "Введите номер тендера для поиска по базе госзакупок"
   - Автоматический импорт данных из ЕИС/zakupki.gov.ru

2. **Кнопка**: "найти" — поиск и автозаполнение

**Кнопки выбора:**

- "отмена" — закрытие модалки
- "добавить вручную" — переход к форме ручного ввода

#### Модальное окно "Добавление тендера" (ручной ввод)

**Заголовок:**

- "Добавление тендера"
- Подзаголовок: "Введите все необходимые данные по тендеру"
- Кнопка закрытия (×)

**Поля формы (14 полей):**

1. **Номер закупки *** — текстовое поле (обязательное)
   - Уникальный идентификатор закупки

2. **Способ определения** — текстовое поле
   - Метод: аукцион, конкурс, запрос котировок и т.д.

3. **Тип** — выпадающий список (combobox)
   - Из справочника "Типы"

4. **Заказчик** — текстовое поле
   - Организация-заказчик

5. **Предмет закупки *** — текстовое поле (обязательное)
   - Описание товаров/услуг

6. **Площадка** — текстовое поле
   - Электронная площадка (например, ZakazRF, ESTP)

7. **НМЦК (руб.) *** — текстовое поле (обязательное)
   - Начальная (максимальная) цена контракта

8. **Обеспечение заявки** — текстовое поле
   - Сумма банковской гарантии для участия

9. **Обеспечение контракта** — текстовое поле
   - Сумма гарантии исполнения контракта

10. **Проект** — текстовое поле
    - Название проекта для группировки

11. **Дата окончания подачи заявки *** — календарь + время (обязательное)
    - Дедлайн подачи заявки
    - Формат: дата + время (00:00)

12. **Дата проведения аукциона** — календарь + время
    - Дата торгов (если применимо)

13. **Дата подведения итогов** — календарь + время
    - Дата объявления победителя

14. **Дата рассмотрения заявки** — календарь + время
    - Дата проверки заявок на соответствие

**Кнопки:**

- "закрыть" — отмена
- "добавить тендер" — создание записи

### Ключевые особенности страницы "Тендеры"

**Два способа добавления тендера:**

1. **Автоматический импорт**:
   - Ввод номера закупки
   - Поиск в базе госзакупок (zakupki.gov.ru)
   - Автоматическое заполнение всех полей
   - Быстрое добавление (1 клик)

2. **Ручной ввод**:
   - 14 полей формы
   - 4 обязательных поля (отмечены *)
   - Полный контроль над данными
   - Для закупок вне ЕИС

**Таблица с 26 колонками:**

- **Самая широкая таблица в CRM**
- Все данные тендера в одном экране
- Кнопка "Настройки таблицы" для скрытия колонок
- Сортировка по 10 колонкам

**Интеграция с zakupki.gov.ru:**

- Автоматический импорт по номеру
- Прямая ссылка на тендер в колонке "Номер закупки"
- Открывается в новом окне

**Счетчики в реальном времени:**

- Количество тендеров
- Общая сумма контрактов
- Обновляются при фильтрации

**Ссылка на комментарий:**

- Каждая строка имеет ссылку "Перейти в коментарии."
- Открывает карточку тендера (`/tenders/{id}/`)

**Действия с тендером:**

- Иконка просмотра (󰏫) — открывает карточку
- Иконка удаления (󰆴) — удаляет тендер

**Связь с другими модулями:**

- **Справочник "Типы"**: выбор типа закупки
- **Справочник "Сотрудники"**: назначение 4 ролей (менеджер, тендерный специалист, инвестор, реализатор)
- **Тендерный отдел**: этап тендера отображается в таблице
- **Реализация**: переход на этапы реализации после победы

**UX-решения:**

- **3 вкладки**: быстрая фильтрация (в работе/архив/все)
- **Скрытые фильтры**: экономия пространства
- **9 иконок**: быстрый доступ к основным фильтрам
- **Счетчики**: мгновенная визуализация объема работы
- **Настройки таблицы**: персонализация отображения
- **Два способа добавления**: гибкость ввода

**Недостатки:**

- **26 колонок**: перегруженность таблицы
- **Горизонтальная прокрутка**: неудобство просмотра
- **Нет группировки**: нельзя свернуть тендеры по проекту/заказчику
- **Нет массовых операций**: нельзя выбрать несколько тендеров
- **Нет экспорта**: отсутствует кнопка "Экспорт в Excel"
- **Нет быстрых фильтров**: иконки без подсказок

**Рекомендации для разработки:**

- Уменьшить количество видимых колонок по умолчанию (10-15)
- Добавить группировку по проекту/заказчику
- Реализовать чекбоксы для массовых операций
- Добавить экспорт в Excel/CSV
- Реализовать закрепление первых 3-4 колонок при прокрутке
- Добавить tooltips для иконок быстрых фильтров
- Реализовать сохранение настроек таблицы (колонки, сортировка)
- Добавить цветовую кодировку этапов (красный = срочно, зеленый = выиграли)
- Реализовать drag-and-drop для изменения порядка колонок
- Добавить фильтры в заголовках колонок (как в Excel)

**Сравнение с канбан-досками:**

- **Тендерный отдел**: канбан-доска (визуальный workflow)
- **Страница "Тендеры"**: таблица (детальный просмотр)
- **Назначение**: разные способы представления одних данных
- **Рекомендация**: добавить переключатель "Канбан/Таблица"

**Бизнес-процесс:**

1. Пользователь находит тендер на zakupki.gov.ru
2. Копирует номер закупки
3. Открывает модалку "Добавить закупку"
4. Вставляет номер и нажимает "найти"
5. Система автоматически заполняет все поля
6. Пользователь проверяет данные и добавляет тендер
7. Тендер появляется в таблице и на канбан-доске "Тендерный отдел"
8. Начинается работа по этапам

### 3.10. Детальный анализ страницы "Задачи"

#### Структура страницы (`/tasks`)

**Назначение:** Управление задачами сотрудников по тендерам и заявкам

**Заголовок:**

- **Кнопка**: меню (гамбургер)
- **Название**: "Задачи"
- **Поиск**: встроенное поле в заголовке + кнопка "найти"
- **Статус**: индикатор
- **Кнопка**: дополнительное действие

**Вкладки (5 категорий задач):**

1. **Мои задачи** — задачи текущего пользователя (по умолчанию)
2. **Контроль задач** — задачи подчиненных (для руководителей)
3. **Все задачи** — полный список всех задач
4. **Возврат** — задачи по возврату товаров
5. **Склад** — задачи по складским операциям

**Панель фильтров:**

- **Кнопка**: "Показать фильтры" + "Сбросить"
- **4-5 иконок**: быстрые фильтры (󰍝 󰍝 󰍝 󰍝)

**Таблица задач (17 колонок):**

1. **Статус** — индикатор выполнения задачи
   - Визуальный маркер (цвет/иконка)

2. **№** — порядковый номер задачи (сортировка)

3. **№ контракта** — номер тендера/контракта (сортировка)
   - Связь с модулем "Тендерный отдел"

4. **№ счета / заявки** — номер заявки
   - Связь с модулем "Реализация"

5. **Сумма** — сумма контракта/заявки
   - В рублях

6. **Этап/заявка** — текущий этап тендера/заявки
   - Контекст задачи

7. **Название** — описание задачи
   - Что нужно сделать

8. **Кто назначил** — сотрудник, создавший задачу
   - Из справочника "Сотрудники"

9. **Ответственный исполнитель** — кому назначена задача
   - Из справочника "Сотрудники"

10. **Подтвердил/Отказал** — статус выполнения
    - Подтверждение или отказ от выполнения

11. **Дата подтверждения** — дата подтверждения выполнения
    - Фактическое время

12. **Комментарий** — основной комментарий к задаче
    - Пояснения от постановщика

13. **Доп. комментарий** — дополнительный комментарий
    - Пояснения от исполнителя

14. **Время постановки задачи** — дата и время создания (сортировка по убыванию)
    - По умолчанию сортировка по этой колонке

15. **Время выполнения (назначенное)** — дедлайн (сортировка)
    - Плановое время выполнения

16. **Время выполнения (фактическое)** — реальное время завершения (сортировка)
    - Когда задача была выполнена

17. **Действие** — кнопки редактирования/удаления (сортировка)

**Состояние:**

- Таблица пустая ("Ничего не найдено")
- Пагинация: 10 строк на страницу
- 0 задач в базе

### Ключевые особенности страницы "Задачи"

**5 вкладок для разных ролей:**

1. **Мои задачи**: персональный список задач пользователя
2. **Контроль задач**: задачи подчиненных (для руководителей/менеджеров)
3. **Все задачи**: общий список для администраторов
4. **Возврат**: специальные задачи по возврату товаров
5. **Склад**: складские операции и инвентаризация

**Встроенный поиск в заголовке:**

- Поисковое поле размещено в заголовке страницы
- Не требует раскрытия панели фильтров
- Быстрый доступ к поиску задач

**Автоматическое создание задач:**

- Задачи создаются автоматически при переходе тендера/заявки на новый этап
- Назначаются ответственному исполнителю из роли на этапе
- Связаны с номером контракта и заявки

**Workflow выполнения задачи:**

1. Задача создается автоматически (или вручную руководителем)
2. Исполнитель видит задачу в списке "Мои задачи"
3. Исполнитель выполняет задачу
4. Исполнитель подтверждает выполнение
5. Система фиксирует фактическое время выполнения
6. Задача переходит в статус "Выполнено"

**Контроль выполнения:**

- **Время постановки**: когда задача была создана
- **Назначенное время**: дедлайн выполнения
- **Фактическое время**: реальное время завершения
- **Превышение сроков**: автоматический расчет задержек

**Связь с другими модулями:**

- **Тендерный отдел**: задачи по этапам тендеров (№ контракта)
- **Реализация**: задачи по заявкам (№ заявки)
- **Сотрудники**: назначение исполнителей и постановщиков
- **Возврат**: специальная вкладка для задач по возвратам
- **Склад**: специальная вкладка для складских задач

**UX-решения:**

- **5 вкладок**: разделение задач по типам и ролям
- **Поиск в заголовке**: быстрый доступ без открытия фильтров
- **Статус визуально**: индикатор в первой колонке
- **Сортировка по дате**: новые задачи сверху (по умолчанию)
- **17 колонок**: полная информация о задаче

**Недостатки:**

- **Нет кнопки "Добавить"**: нельзя создать задачу вручную из этого интерфейса
- **17 колонок**: перегруженность таблицы
- **Нет приоритета**: отсутствует колонка "Приоритет" (срочно/важно/обычно)
- **Нет типа задачи**: непонятно, что это за задача (звонок, документ, оплата и т.д.)
- **Нет уведомлений**: не видно, отправляются ли push/email при назначении
- **Нет чек-листа**: нет возможности разбить задачу на подзадачи
- **Нет времени на выполнение**: нет оценки трудозатрат

**Рекомендации для разработки:**

- Добавить кнопку "Добавить задачу" для ручного создания
- Добавить колонку "Приоритет" (высокий/средний/низкий) с цветовой кодировкой
- Добавить колонку "Тип задачи" (звонок, документ, оплата, встреча, проверка)
- Реализовать систему уведомлений (push/email/SMS)
- Добавить чек-лист подзадач внутри задачи
- Реализовать оценку трудозатрат (в часах)
- Добавить возможность делегирования задачи
- Реализовать комментарии с упоминаниями (@mention)
- Добавить файлы/вложения к задаче
- Реализовать календарное представление (как в Google Calendar)
- Добавить фильтр "Просроченные задачи" (красным цветом)
- Реализовать групповое назначение задач

**Сравнение с другими модулями:**

- **Календарь**: визуальное представление задач по датам
- **Задачи**: табличное представление с фильтрами
- **Рекомендация**: добавить переключатель "Таблица/Календарь"

**Бизнес-процесс:**

1. Тендер/заявка переходит на новый этап
2. Система автоматически создает задачу для ответственного
3. Исполнитель получает уведомление (предполагается)
4. Исполнитель видит задачу в "Мои задачи"
5. Исполнитель выполняет задачу
6. Исполнитель нажимает "Подтвердить выполнение"
7. Руководитель видит выполнение в "Контроль задач"
8. Система фиксирует фактическое время
9. Тендер/заявка может переходить на следующий этап

**Роли и доступ:**

- **Исполнитель**: видит только "Мои задачи"
- **Менеджер**: видит "Мои задачи" + "Контроль задач"
- **Руководитель**: видит все вкладки
- **Администратор**: полный доступ ко всем задачам

### 3.11. Детальный анализ страницы "Календарь"

#### Структура страницы (`/calendar`)

**Назначение:** Визуальное представление задач и событий в календарном формате

**Заголовок:**

- **Кнопка**: меню (гамбургер)
- **Название**: "Календарь"
- **Статус**: индикатор
- **Кнопка**: дополнительное действие

**Панель фильтров:**

- **Кнопка**: "Показать фильтры"
- **1 иконка**: быстрый фильтр (󰍝)

**Панель навигации:**

- **Кнопки навигации**:
  - "Пред" — предыдущий период
  - "След" — следующий период
  - "Сегодня" — переход на текущую дату (disabled если текущий месяц)

- **Заголовок периода**: "ноябрь 2025 г." (h2)

- **Кнопки режимов просмотра** (toggle group):
  - "Месяц" — месячное представление (активна по умолчанию)
  - "Неделя" — недельное представление
  - "День" — дневное представление

**Календарная сетка (месячный вид):**

- **Grid**: таблица с днями месяца
- **Заголовки колонок**: пн, вт, ср, чт, пт, сб, вс
- **6 строк недель**: с 27 октября по 7 декабря
- **Каждая ячейка (gridcell)**:
  - Дата (число месяца)
  - Кликабельная область для добавления события
  - События дня (если есть)

**Реальное событие (8 ноября):**

- **Текст события**:
  - "СП № 1 по заявке № 1"
  - "проекта № 6507 (Товар у заказчика)"
- **Контекст**: связано с заявкой модуля "Реализация"
- **Этап**: "Товар у заказчика"

**Состояние:**

- Текущий месяц: ноябрь 2025
- 1 событие на 8 ноября

### Ключевые особенности страницы "Календарь"

**3 режима просмотра:**

1. **Месяц**: классический календарь с сеткой 7x6 (недели x дни)
2. **Неделя**: детальное представление 7 дней (предполагается)
3. **День**: почасовое представление 1 дня (предполагается)

**Автоматическое отображение событий:**

- События создаются из задач (модуль "Задачи")
- Отображаются на дату выполнения/дедлайна
- Связаны с тендерами и заявками

**Формат события:**

- **Строка 1**: "СП № {номер} по заявке № {номер}"
- **Строка 2**: "проекта № {номер} ({этап})"
- Компактное представление основной информации

**Навигация:**

- Стрелки "Пред"/"След" для перемещения между периодами
- Кнопка "Сегодня" для быстрого возврата
- Заголовок с текущим периодом

**Интерактивность:**

- Клик по дню — добавление события (предполагается)
- Клик по событию — открытие детальной информации (предполагается)
- Переключение режимов просмотра

**Связь с другими модулями:**

- **Задачи**: события из задач с дедлайнами
- **Реализация**: отображение этапов заявок (СП)
- **Тендерный отдел**: события по тендерам (предполагается)

**UX-решения:**

- **Стандартный календарь**: привычный интерфейс
- **3 режима**: гибкость представления
- **Быстрая навигация**: стрелки + "Сегодня"
- **Компактные события**: не перегружают ячейки

**Недостатки:**

- **Нет цветовой кодировки**: события одного цвета, непонятен тип/приоритет
- **Нет легенды**: не видно, что означают разные события
- **Нет фильтров по типу**: нельзя показать только задачи или только тендеры
- **Нет перетаскивания**: нельзя изменить дату drag-and-drop
- **Нет времени**: не видно время события в месячном виде
- **Нет количества**: если событий много, не видно сколько их
- **Нет создания**: непонятно, как добавить событие вручную

**Рекомендации для разработки:**

- Добавить цветовую кодировку (тендеры = синий, задачи = зеленый, дедлайны = красный)
- Реализовать легенду типов событий
- Добавить фильтры: по типу события, по сотруднику, по проекту
- Реализовать drag-and-drop для изменения дат
- Показывать время события в месячном виде (если есть)
- Добавить счетчик "+N событий" если их больше 3-х
- Реализовать кнопку "Добавить событие" или клик по дню
- Добавить всплывающую подсказку с деталями при наведении
- Реализовать мини-календарь для быстрой навигации
- Добавить поиск событий
- Реализовать экспорт в iCal/Google Calendar
- Добавить уведомления/напоминания за N дней до события

**Сравнение с модулем "Задачи":**

- **Задачи**: табличное представление с фильтрами
- **Календарь**: визуальное представление по датам
- **Общие данные**: одни и те же задачи/события
- **Рекомендация**: синхронизация изменений между модулями

**Типы событий (предполагаемые):**

1. **Дедлайны задач**: из модуля "Задачи"
2. **Даты тендеров**: подача заявки, аукцион, подведение итогов
3. **Этапы заявок**: переход СП между этапами
4. **Судебные заседания**: из модуля "Взыскание долгов"
5. **Логистика**: даты доставки

**Бизнес-процесс:**

1. Задача/событие создается в соответствующем модуле
2. Система автоматически добавляет событие в календарь
3. Событие отображается на дату выполнения/дедлайна
4. Пользователь видит события в календарном представлении
5. Клик по событию → переход к деталям в исходном модуле
6. Изменение даты (если поддерживается) → обновление в модуле

**Режим "Неделя" (предполагаемый):**

- Почасовая сетка с 00:00 до 23:00
- 7 колонок (понедельник — воскресенье)
- Детальное отображение времени событий

**Режим "День" (предполагаемый):**

- Почасовая сетка для 1 дня
- Полное расписание с минутной точностью
- Максимум деталей о каждом событии

## 4. Анализ данных и интеграций

- **Источники данных**: поддерживается импорт тендеров по номеру из внешней базы (вероятно ЕИС/zakupki.gov), что ускоряет заполнение полей.
- **Структура карточки тендера**: включает реквизиты закупки (номер, предмет, площадка, НМЦК, обеспечительные суммы), структуру исполнителей (менеджер, тендерный специалист, инвестор, реализатор), заказчика, локацию, даты (подача, рассмотрение, торги, итоги).
- **Разделение ролей**: система явно хранит назначенных сотрудников по каждому этапу, что позволяет фильтровать показатели и строить персональные отчеты.
- **Финансовые параметры**: настройки распределения процентов и налога указывают на автоматическое формирование выплат.
- **Канбан-метаданные**: каждая колонка содержит сумму и количество, что подразумевает агрегирующие запросы по статусу.

## 5. UX/UI наблюдения

- Единый левый сайдбар с иконками, активная вкладка подсвечивается — быстрое переключение.
- Верхние панели в разделах минималистичные, с акцентом на основное действие («Добавить тендер», «Перенести...», фильтры).
- Таблицы используют компактное отображение, но перегружены колонками — требуется настройка видимости.
- Фильтры скрыты по умолчанию, раскрываются по нажатию — экономия пространства.
- Канбан-доски отображают сумму и количество прямо в заголовках — удобная визуализация, но нет графиков.
- Отсутствует явная цветовая кодировка статусов; визуальные различия ограничены.

## 6. Выявленные сильные стороны

- **Полный цикл**: охват этапов от поиска до закрытия контракта и получения оплаты.
- **Гибкая аналитика**: множество специализированных отчетов.
- **Ролевая модель**: привязка ответственных на каждом шаге.
- **Интеграция с внешними источниками**: быстрый импорт тендеров.
- **Канбан и календарь**: визуализация нагрузки и сроков.
- **Настраиваемые справочники**: снижение дублирования данных.

## 7. Недостатки и зоны роста конкурента

- Табличные представления перегружены — требуется ручная настройка отображения.
- Нет визуальных графиков по статусам/финансам прямо в разделах (только в отчетах, и то в виде таблиц).
- Нет явного трекинга коммуникаций или вложений на канбан-этапах (по UI не видно файловых менеджеров).
- Сложность модальной логики: перекрывающиеся оверлеи затрудняют взаимодействие (видно по поведению интерфейса).
- Календарь отображает события, но не показывает контекст тендера/задачи без клика.
- Не заметны инструменты AI/автоматических подсказок.

## 8. Рекомендации для нашего модуля «Тендеры»

1. **Импорт и синхронизация**
   - Реализовать поиск по номеру закупки с автозаполнением (EИС API) + отслеживание изменений (обновление статусов, дат).
   - Поддержать импорт из CSV/Excel с валидацией (использовать уже запланированный модуль lib/csv/).

2. **Структура данных**
   - Хранить отдельные сущности: `Tender`, `TenderStage`, `TenderTask`, `TenderContact`, `TenderAttachment`, `TenderFinancial`.
   - Добавить поддержку вложений через Supabase Storage (к карточкам и задачам).
   - Использовать pgvector для семантического поиска (похожие тендеры, рекомендации категорий).

3. **Пользовательские роли и ответственность**
   - Ввести роли: менеджер, тендерный специалист, реализатор, инвестор, контролер оплат.
   - Настроить автоматические задачи/уведомления для смены этапа (через Supabase Functions + cron).

4. **UX/UI улучшения**
   - Использовать канбан с drag-and-drop на базе компонентов в `components/kanban/*`.
   - Добавить цветовые индикаторы SLA (просрочки, критические даты).
   - Облегчить таблицы: предусмотреть набор «преднастроенных» представлений и сохраненных фильтров.
   - Интегрировать виджеты графиков (Chart.js) прямо в верхней части страниц: тренд выигрышей, конверсия, объём по этапам.

5. **Аналитика и AI**
   - Автокатегоризация тендеров и прогноз вероятности победы (OpenAI + исторические данные).
   - Генерация саммари по тендеру (lib/ai/summary) для быстрого обзора.
   - Предиктивные уведомления о дедлайнах (AI-анализ календаря).

6. **Финансы и выплаты**
   - Гибкая настройка распределения дохода (в % и фикс), сохранение шаблонов.
   - Автоматическое создание planned transactions в `transactions` при подтверждении этапа.
   - Отчетность с диаграммами: cashflow, просроченные оплаты, эффективность менеджеров.

7. **Процессы и интеграции**
   - REST/GraphQL API для обмена с внешними системами (например, бухгалтерия).
   - Вебхуки для уведомлений (Telegram, email, внутрикабинетная лента).
   - Интеграция с календарями (Google/Outlook) через ICS экспорт.

## 9. План дальнейших действий

1. Сформировать требования к модулю «Тендеры» на основе рекомендаций (Functional Spec).
2. Спроектировать схему БД в `db/migrations` (тендеры, этапы, распределение, вложения).
3. Разработать API и утилиты в `lib/` (Supabase сервисы, AI интеграции).
4. Реализовать UI-страницы в `app/(protected)/tenders/*` с канбаном и таблицами.
5. Настроить отчеты и графики (react-chartjs-2) + экспорт CSV.
6. Покрыть ключевую логику тестами (Vitest + Playwright e2e для канбана и импорта).

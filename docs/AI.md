# ü§ñ AI-—Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

> **–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
> **–í–µ—Ä—Å–∏—è:** 1.0.0

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä AI-—Ñ—É–Ω–∫—Ü–∏–π](#–æ–±–∑–æ—Ä-ai-—Ñ—É–Ω–∫—Ü–∏–π)
2. [AI –ß–∞—Ç](#ai-—á–∞—Ç)
3. [AI –°–æ–≤–µ—Ç–Ω–∏–∫](#ai-—Å–æ–≤–µ—Ç–Ω–∏–∫)
4. [AI –ê–Ω–∞–ª–∏—Ç–∏–∫–∞](#ai-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
5. [Embeddings –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫](#embeddings-–∏-—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π-–ø–æ–∏—Å–∫)
6. [RAG –∏ Knowledge Graph](#rag-–∏-knowledge-graph)
7. [–ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è](#–∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è)
8. [–ü–∞—Ä—Å–∏–Ω–≥ —á–µ–∫–æ–≤](#–ø–∞—Ä—Å–∏–Ω–≥-—á–µ–∫–æ–≤)
9. [–ö–æ–º–∞–Ω–¥—ã —á–∞—Ç–∞](#–∫–æ–º–∞–Ω–¥—ã-—á–∞—Ç–∞)
10. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenRouter](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-openrouter)
11. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

---

## –û–±–∑–æ—Ä AI-—Ñ—É–Ω–∫—Ü–∏–π

FinApp –∏–º–µ–µ—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö AI —Ñ—É–Ω–∫—Ü–∏–∏:

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ú–æ–¥–µ–ª—å |
|---------|----------|--------|
| **AI –ß–∞—Ç** | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ —Å 44+ Function Calling | gpt-4o-mini |
| **AI –°–æ–≤–µ—Ç–Ω–∏–∫** | –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ | gpt-4o-mini |
| **AI –ê–Ω–∞–ª–∏—Ç–∏–∫–∞** | –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π | gpt-4o |

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (44+ —Ñ—É–Ω–∫—Ü–∏–∏)

**–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:** –¥–æ–±–∞–≤–∏—Ç—å, —É–¥–∞–ª–∏—Ç—å, –æ–±–Ω–æ–≤–∏—Ç—å, –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫, –ø–æ–∏—Å–∫  
**–°—á–µ—Ç–∞:** —Å–æ–∑–¥–∞—Ç—å, —É–¥–∞–ª–∏—Ç—å, –±–∞–ª–∞–Ω—Å, –ø–µ—Ä–µ–≤–æ–¥—ã  
**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:** —Å–æ–∑–¥–∞—Ç—å, —É–¥–∞–ª–∏—Ç—å, —Å–ø–∏—Å–æ–∫  
**–ë—é–¥–∂–µ—Ç—ã:** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –ø–æ–∫–∞–∑–∞—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å  
**–ü–ª–∞–Ω—ã:** —Å–æ–∑–¥–∞—Ç—å, –ø–æ–∫–∞–∑–∞—Ç—å, –¥–æ–±–∞–≤–∏—Ç—å –≤–∑–Ω–æ—Å  
**–ó–∞–º–µ—Ç–∫–∏:** —Å–æ–∑–¥–∞—Ç—å, —É–¥–∞–ª–∏—Ç—å, –ø–æ–∫–∞–∑–∞—Ç—å  
**–§–∏—Ç–Ω–µ—Å:** –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞  
**–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–≤–æ–¥–∫–∞, —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, —Ç—Ä–µ–Ω–¥—ã

---

## AI –ß–∞—Ç

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –°–æ–æ–±—â–µ–Ω–∏–µ ‚Üí API /api/ai/chat ‚Üí OpenAI GPT-4o-mini
                                ‚Üì
                        –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ intent
                                ‚Üì
                    –í—ã–∑–æ–≤ Tool Handler (Function Calling)
                                ‚Üì
                    –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (Supabase)
                                ‚Üì
                    –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

### Vercel AI SDK

–ß–∞—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Vercel AI SDK**:

- ‚úÖ Streaming –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π  
- ‚úÖ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –ë–î

### –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI

–ß–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```
### –°—á–µ—Ç–∞:
- –û—Å–Ω–æ–≤–Ω–æ–π: 25000.00 RUB
- –°–±–µ—Ä–µ–∂–µ–Ω–∏—è: 150000.00 RUB

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
- 11.10.2025: -1500.00 —Ä—É–±. - –ü—è—Ç—ë—Ä–æ—á–∫–∞
- 10.10.2025: +50000.00 —Ä—É–±. - –ó–∞—Ä–ø–ª–∞—Ç–∞

### –ë—é–¥–∂–µ—Ç—ã:
- –ü—Ä–æ–¥—É–∫—Ç—ã: 12000.00 / 15000.00 —Ä—É–±. (80%)
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```
üë§ –í—ã: –ü–æ—Ç—Ä–∞—Ç–∏–ª 500 —Ä—É–±–ª–µ–π –Ω–∞ –∫–æ—Ñ–µ
ü§ñ ChatGPT: ‚úÖ –ó–∞–ø–∏—Å–∞–ª! –†–∞—Å—Ö–æ–¥ 500‚ÇΩ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ï–¥–∞"

üë§ –í—ã: –ü–æ–∫–∞–∂–∏ –º–æ–∏ —Ç—Ä–∞—Ç—ã –∑–∞ –Ω–µ–¥–µ–ª—é
ü§ñ ChatGPT: üìä –í–∞—à–∏ —Ç—Ä–∞—Ç—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π:
- –ï–¥–∞: 2,500‚ÇΩ
- –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç: 800‚ÇΩ
–í—Å–µ–≥–æ: 4,500‚ÇΩ

üë§ –í—ã: –°–æ–∑–¥–∞–π –±—é–¥–∂–µ—Ç 15000 –Ω–∞ –µ–¥—É –≤ –º–µ—Å—è—Ü
ü§ñ ChatGPT: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏–ª –º–µ—Å—è—á–Ω—ã–π –±—é–¥–∂–µ—Ç –Ω–∞ "–ï–¥—É": 15,000‚ÇΩ
```

---

## AI –°–æ–≤–µ—Ç–Ω–∏–∫

### –ü—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞

1. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞)
2. **–†–∞—Å—á—ë—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π** (–¥–æ—Ö–æ–¥, —Ä–∞—Å—Ö–æ–¥—ã, —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è)
3. **–ê–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è**
   - Savings Rate (–ø—Ä–æ—Ü–µ–Ω—Ç —Å–±–µ—Ä–µ–∂–µ–Ω–∏–π)
   - Expense Stability
   - Budget Adherence
   - Emergency Fund
   - Overall Score (0-100)
4. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Ç–µ—á–µ–∫ –¥–µ–Ω–µ–≥**
5. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∏–¥–µ–∞–ª—å–Ω—ã–º –±—é–¥–∂–µ—Ç–æ–º** (–ø—Ä–∞–≤–∏–ª–æ 50/30/20)
6. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π** (OpenAI)
7. **–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π**

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

- üìä **–û—Ü–µ–Ω–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è** (A, B, C, D, F)
- üí∞ **–£—Ç–µ—á–∫–∏ –¥–µ–Ω–µ–≥**
- üìà **–ò–¥–µ–∞–ª—å–Ω—ã–π –±—é–¥–∂–µ—Ç**
- üí° **–°–æ–≤–µ—Ç—ã**
- üìã **–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π**

---

## AI –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

### –ü—Ä–æ—Ü–µ—Å—Å

1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (90 –¥–Ω–µ–π)
2. –†–∞—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–¥–æ—Ö–æ–¥, —Ä–∞—Å—Ö–æ–¥—ã, –±–∞–ª–∞–Ω—Å)
3. –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
4. OpenAI –∞–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
5. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Å—è—Ü—ã
6. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π (low/medium/high)

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

- üìä **–û—Ü–µ–Ω–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è**
- üìà **–¢—Ä–µ–Ω–¥—ã**
- üí° **–ò–Ω—Å–∞–π—Ç—ã**
- üîÆ **–ü—Ä–æ–≥–Ω–æ–∑**
- ‚ö†Ô∏è **–ê–Ω–æ–º–∞–ª–∏–∏**
- üí¨ **–°–æ–≤–µ—Ç—ã**

---

## Embeddings –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫

### –ß—Ç–æ —ç—Ç–æ

**Embeddings** ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Å–º—ã—Å–ª—É.

```
–û–±—ã—á–Ω—ã–π –ø–æ–∏—Å–∫: "—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç" ‚Üí —Ç–æ–ª—å–∫–æ "—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç"
–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π: "—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç" ‚Üí –ü—è—Ç—ë—Ä–æ—á–∫–∞, –ü–µ—Ä–µ–∫—Ä—ë—Å—Ç–æ–∫, –º–∞–≥–∞–∑–∏–Ω –ø—Ä–æ–¥—É–∫—Ç–æ–≤
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –î–æ–±–∞–≤—å—Ç–µ `OPENAI_API_KEY` –≤ `.env.local`
2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é `20251011_semantic_search_function.sql`
3. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ embeddings:

```bash
npx tsx scripts/generate-embeddings.ts
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { createEmbedding } from "@/lib/ai/embeddings";
import { searchSimilarTransactions } from "@/lib/ai/search";

// –°–æ–∑–¥–∞—Ç—å embedding
const embedding = await createEmbedding("–ü–æ–∫—É–ø–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤");

// –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
const results = await searchSimilarTransactions(embedding, 10, 0.7);
```

### API

```typescript
// –ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
POST /api/ai/categorize
{ "description": "–¢–∞–∫—Å–∏ –Ø–Ω–¥–µ–∫—Å", "direction": "expense" }

// –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
POST /api/ai/semantic-search
{ "query": "–∫–æ—Ñ–µ", "limit": 10, "threshold": 0.7 }
```

### –°—Ç–æ–∏–º–æ—Å—Ç—å

- 20,000 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å embeddings ‚âà **$0.02**
- 1,000 –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–π ‚âà **$0.075**

---

## RAG –∏ Knowledge Graph

### RAG (Retrieval-Augmented Generation)

–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Å–º—ã—Å–ª—É:

```
–ó–∞–ø—Ä–æ—Å: "—Ç–∞–∫—Å–∏"
–ù–∞–π–¥—ë—Ç: –Ø–Ω–¥–µ–∫—Å –¢–∞–∫—Å–∏, Uber, Bolt, –ø–æ–µ–∑–¥–∫–∞ –Ω–∞ –º–∞—à–∏–Ω–µ
```

### KAG (Knowledge-Augmented Generation)

–ì—Ä–∞—Ñ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –¥–∞–Ω–Ω—ã–º–∏:

```
–ö–∞—Ç–µ–≥–æ—Ä–∏—è "–ï–¥–∞" ‚îÄ‚îÄ—Å–≤—è–∑–∞–Ω–∞‚îÄ‚îÄ> –ö–∞—Ç–µ–≥–æ—Ä–∏—è "–¢–∞–∫—Å–∏"
     ‚Üì                              ‚Üì
–û–±—ã—á–Ω–æ: –æ–±–µ–¥ (12:00-14:00)   –û–±—ã—á–Ω–æ: –≤–µ—á–µ—Ä (18:00-22:00)
```

### –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞

```bash
curl -X POST http://localhost:3000/api/ai/graph/build
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

```typescript
GET /api/ai/recommendations

// –û—Ç–≤–µ—Ç:
{
  "recommendations": [
    {
      "type": "spending_pattern",
      "title": "–ß–∞—Å—Ç—ã–µ —Ç—Ä–∞—Ç—ã –Ω–∞ –∫–æ—Ñ–µ",
      "description": "–í—ã —Ç—Ä–∞—Ç–∏—Ç–µ –Ω–∞ –∫–æ—Ñ–µ 3000‚ÇΩ/–º–µ—Å—è—Ü",
      "suggestion": "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≥–æ—Ç–æ–≤–∏—Ç—å –∫–æ—Ñ–µ –¥–æ–º–∞"
    }
  ]
}
```

### –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

```typescript
GET /api/ai/patterns

// –û—Ç–≤–µ—Ç:
{
  "patterns": [
    {
      "type": "weekly",
      "description": "–ö–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É —Ç—Ä–∞—Ç—ã –Ω–∞ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è +150%",
      "categories": ["–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", "–†–µ—Å—Ç–æ—Ä–∞–Ω—ã"]
    }
  ]
}
```

---

## –ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è

### –£–º–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è

–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –°–æ–∑–¥–∞–Ω–∏–µ embedding –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è
2. –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (pgvector)
3. –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (>70% –≤ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
4. GPT —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (–µ—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–µ—è–≤–Ω—ã–π)
5. Fallback –Ω–∞ –ø—Ä–æ—Å—Ç—É—é GPT –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—é

```typescript
POST /api/ai/smart-categorize
{
  "description": "–ü–æ–∫—É–ø–∫–∞ –∫–æ—Ñ–µ –≤ Starbucks",
  "threshold": 0.75
}

// –û—Ç–≤–µ—Ç:
{
  "categoryId": "uuid",
  "categoryName": "–ö–∞—Ñ–µ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã",
  "confidence": 0.92,
  "explanation": "–ù–∞–π–¥–µ–Ω–æ 5 –ø–æ—Ö–æ–∂–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π..."
}
```

### –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

| –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è |
|----------------|-----------|
| –ø—Ä–æ–¥—É–∫—Ç, –µ–¥–∞, –º–∞–≥–∞–∑–∏–Ω, –ø—è—Ç—ë—Ä–æ—á–∫–∞ | –ü—Ä–æ–¥—É–∫—Ç—ã |
| –∫–∞—Ñ–µ, —Ä–µ—Å—Ç–æ—Ä–∞–Ω, –æ–±–µ–¥, –∫–æ—Ñ–µ | –ö–∞—Ñ–µ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã |
| —Ç–∞–∫—Å–∏, uber, –º–µ—Ç—Ä–æ, –±–µ–Ω–∑–∏–Ω | –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç |
| –∞–ø—Ç–µ–∫–∞, –ª–µ–∫–∞—Ä—Å—Ç–≤–∞, –≤—Ä–∞—á | –ó–¥–æ—Ä–æ–≤—å–µ |
| –∫–∏–Ω–æ, –∏–≥—Ä—ã, –ø–æ–¥–ø–∏—Å–∫–∞, netflix | –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è |

---

## –ü–∞—Ä—Å–∏–Ω–≥ —á–µ–∫–æ–≤

### –ü—Ä–æ—Ü–µ—Å—Å

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç —á–µ–∫–∞
2. OpenAI GPT-4o-mini –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
3. –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
4. AI-—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ —Å –ë–î
5. –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –ø–æ–∑–∏—Ü–∏—è–º–∏

### API

```typescript
POST /api/ai/process-receipt
{
  "receiptText": "–ü—è—Ç—ë—Ä–æ—á–∫–∞\n10.11.2025\n–û–Ω–∏–≥–∏—Ä–∏ 2—à—Ç x 89.90...",
  "preview": true
}

// –û—Ç–≤–µ—Ç:
{
  "success": true,
  "data": {
    "storeName": "–ü—è—Ç—ë—Ä–æ—á–∫–∞",
    "date": "2025-11-10",
    "items": [...],
    "totalAmount": 224.80
  }
}
```

### AI-—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤

- **–¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ:** "–û–Ω–∏–≥–∏—Ä–∏" = "–û–Ω–∏–≥–∏—Ä–∏" ‚úÖ
- **–ß–∞—Å—Ç–∏—á–Ω–æ–µ:** "–û–Ω–∏–≥–∏—Ä–∏ –§—É–¥–∂–∏" —Å–æ–¥–µ—Ä–∂–∏—Ç "–û–Ω–∏–≥–∏—Ä–∏" ‚úÖ
- **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ:** "Coca-Cola Zero 0.5–ª" ‚Üí "–ö–æ–ª–∞" (95%) ‚úÖ

---

## –ö–æ–º–∞–Ω–¥—ã —á–∞—Ç–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

```
–î–æ–±–∞–≤—å 500 —Ä—É–±–ª–µ–π –Ω–∞ –∫–æ—Ñ–µ
–¢—Ä–∞—Ç–∞ 1200—Ä –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç—ã
–ü–æ—Ç—Ä–∞—Ç–∏–ª 350 —Ä—É–± –Ω–∞ –æ–±–µ–¥
–î–æ—Ö–æ–¥ 50000 –∑–∞—Ä–ø–ª–∞—Ç–∞
```

### –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å

```
–ü–æ–∫–∞–∂–∏ –±–∞–ª–∞–Ω—Å
–°–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –Ω–∞ —Å—á–µ—Ç–∞—Ö?
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```
–°–∫–æ–ª—å–∫–æ —è —Ç—Ä–∞—á—É –Ω–∞ –µ–¥—É?
–†–∞—Å—Ö–æ–¥—ã –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
–°–∫–æ–ª—å–∫–æ —è –ø–æ—Ç—Ä–∞—Ç–∏–ª?
```

### –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Å—É–º–º

- 500, 1200—Ä, 350 —Ä—É–±, 2500‚ÇΩ
- 5–∫, 10 —Ç—ã—Å—è—á

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenRouter

### –ß—Ç–æ —Ç–∞–∫–æ–µ OpenRouter

–ï–¥–∏–Ω—ã–π API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ—Ç–Ω—è–º AI –º–æ–¥–µ–ª–µ–π:
- OpenAI (GPT-4o, GPT-4o-mini)
- Anthropic (Claude 3.5 Sonnet)
- Google (Gemini 2.0)
- Meta (Llama 3.1)
- Qwen, DeepSeek –∏ –¥—Ä—É–≥–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://openrouter.ai/
2. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á –≤ https://openrouter.ai/settings/keys
3. –î–æ–±–∞–≤—å—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
OPENROUTER_API_KEY=sk-or-v1-xxxxxxxxxxxxx
```

### –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π

```typescript
// lib/ai/openrouter.ts
export const MODELS = {
  COMMANDS: "openai/gpt-4o-mini",   // –ë—ã—Å—Ç—Ä–∞—è –∏ –¥–µ—à—ë–≤–∞—è
  ANALYTICS: "openai/gpt-4o",        // –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è
};
```

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏

- `google/gemini-2.0-flash-exp:free`
- `meta-llama/llama-3.1-8b-instruct:free`
- `mistralai/mistral-7b-instruct:free`

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å—Ö–æ–¥–æ–≤

https://openrouter.ai/settings/usage

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### RLS –ø–æ–ª–∏—Ç–∏–∫–∏

- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç `user_id`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- Admin –∫–ª–∏–µ–Ω—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ª—É–∂–µ–±–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### API Endpoints

- –í—Å–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `auth.getUser()`
- –í–æ–∑–≤—Ä–∞—Ç 401 –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω

### –õ–∏–º–∏—Ç—ã

- –ú–∞–∫—Å–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- –ú–∞–∫—Å–∏–º—É–º 200 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –õ–∏–º–∏—Ç—ã OpenAI API (–ø–æ –ø–ª–∞–Ω—É)

### API Keys

- ‚úÖ –ö–ª—é—á–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
- ‚úÖ –•—Ä–∞–Ω—è—Ç—Å—è –≤ environment variables

---

## –§–∞–π–ª—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### Frontend

```
app/(protected)/ai-chat/Chat.tsx
app/(protected)/ai-advisor/AIAdvisorClient.tsx
components/ai-analytics/AIAnalyticsContent.tsx
```

### Backend

```
app/api/ai/chat/route.ts
app/api/ai/advisor/route.ts
app/api/ai/analytics/route.ts
app/api/ai/categorize/route.ts
app/api/ai/smart-categorize/route.ts
app/api/ai/process-receipt/route.ts
app/api/ai/semantic-search/route.ts
lib/ai/tool-handlers.ts     # 44+ —Ñ—É–Ω–∫—Ü–∏–∏
lib/ai/advisor.ts           # –õ–æ–≥–∏–∫–∞ —Å–æ–≤–µ—Ç–Ω–∏–∫–∞
lib/ai/embeddings.ts        # –†–∞–±–æ—Ç–∞ —Å embeddings
lib/ai/openrouter.ts        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è OpenRouter
lib/ai/prompts.ts           # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```
.env.local:
OPENAI_API_KEY=sk-...
OPENROUTER_API_KEY=sk-or-v1-...
```

---

## –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞

| –§—É–Ω–∫—Ü–∏—è | –í—Ä–µ–º—è |
|---------|-------|
| AI –ß–∞—Ç | 2-5 —Å–µ–∫ |
| AI –°–æ–≤–µ—Ç–Ω–∏–∫ | 3-8 —Å–µ–∫ |
| AI –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ | 5-10 —Å–µ–∫ |

---

## Troubleshooting

### AI –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `OPENAI_API_KEY` / `OPENROUTER_API_KEY`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ OpenRouter
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

### Embeddings –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é: `npx tsx scripts/generate-embeddings.ts`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤ –ë–î:

```sql
SELECT COUNT(*), COUNT(embedding) 
FROM transactions 
WHERE user_id = 'your-user-id';
```

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ —Å–∏—Å—Ç–µ–º–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

---

**AI-—Ñ—É–Ω–∫—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

–°–∏—Å—Ç–µ–º–∞ –ø–æ–º–æ–≥–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—á—ë—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –∏ –ø–æ–ª—É—á–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

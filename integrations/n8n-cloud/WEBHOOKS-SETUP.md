# ‚ö° Webhooks: –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ 5 –º–∏–Ω—É—Ç

**–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**

---

## ‚úÖ –ß—Ç–æ —Ç–µ–±–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:

- n8n Cloud –∞–∫–∫–∞—É–Ω—Ç (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- API –∫–ª—é—á –∏–∑ Finappka
- Telegram –±–æ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- 5 –º–∏–Ω—É—Ç –≤—Ä–µ–º–µ–Ω–∏

---

## üöÄ –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π Webhook –≤ n8n Cloud

### 1.1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π workflow

1. **–°–∫–∞—á–∞–π —Ñ–∞–π–ª:**
   ```
   /workflows/webhook-telegram-instant.json
   ```

2. **–í n8n Cloud:**
   - Workflows ‚Üí "+" ‚Üí Import from File
   - –í—ã–±–µ—Ä–∏ `webhook-telegram-instant.json`
   - –ù–∞–∂–º–∏ "Import"

### 1.2. –ü–æ–ª—É—á–∏ Webhook URL

1. **–û—Ç–∫—Ä–æ–π –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π workflow**

2. **–ù–∞–∂–º–∏ –Ω–∞ node "Webhook Trigger"**

3. **–°–∫–æ–ø–∏—Ä—É–π Production URL:**
   ```
   https://—Ç–≤–æ–π-workspace.app.n8n.cloud/webhook/finappka-webhook
   ```

4. **–°–æ—Ö—Ä–∞–Ω–∏ —ç—Ç–æ—Ç URL!** –û–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤ —à–∞–≥–µ 3.

### 1.3. –ù–∞—Å—Ç—Ä–æ–π Telegram (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

1. **–í workflow –Ω–∞–π–¥–∏ node "Send to Telegram"**

2. **–ù–∞—Å—Ç—Ä–æ–π Telegram credentials:**
   - Credentials ‚Üí Telegram API
   - –î–æ–±–∞–≤—å —Å–≤–æ–π –±–æ—Ç —Ç–æ–∫–µ–Ω

3. **–£–∫–∞–∂–∏ Chat ID:**
   - Settings ‚Üí Environments
   - `TELEGRAM_CHAT_ID` = —Ç–≤–æ–π ID

---

## üîê –®–∞–≥ 2: –°–æ–∑–¥–∞–π —Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏

### 2.1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É

**–í PowerShell:**
```powershell
-join ((48..57) + (65..90) + (97..122) | Get-Random -Count 32 | % {[char]$_})
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç (–ø—Ä–∏–º–µ—Ä):**
```
aB3dE7fG9hJ2kL4mN6pQ8rS1tU5vW0xY
```

### 2.2. –°–æ—Ö—Ä–∞–Ω–∏ —Å–µ–∫—Ä–µ—Ç –≤ n8n

1. **Settings ‚Üí Environments**

2. **–î–æ–±–∞–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:**
   ```
   Name: FINAPPKA_WEBHOOK_SECRET
   Value: aB3dE7fG9hJ2kL4mN6pQ8rS1tU5vW0xY
   ```

3. **Save**

### 2.3. –°–æ—Ö—Ä–∞–Ω–∏ —Å–µ–∫—Ä–µ—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞

–°–∫–æ–ø–∏—Ä—É–π —ç—Ç—É –∂–µ —Å—Ç—Ä–æ–∫—É - –æ–Ω–∞ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ webhook –≤ Finappka.

---

## üì° –®–∞–≥ 3: –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π Webhook –≤ Finappka

### 3.1. –ß–µ—Ä–µ–∑ API (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–í PowerShell:**

```powershell
$headers = @{
    "Authorization" = "Bearer fpa_live_—Ç–≤–æ–π_api_–∫–ª—é—á"
    "Content-Type" = "application/json"
}

$body = @{
    url = "https://—Ç–≤–æ–π-workspace.app.n8n.cloud/webhook/finappka-webhook"
    events = @("transaction.created")
    secret = "aB3dE7fG9hJ2kL4mN6pQ8rS1tU5vW0xY"
    name = "n8n Telegram Notifications"
    description = "–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram"
} | ConvertTo-Json

Invoke-RestMethod -Uri "https://—Ç–≤–æ–π-–¥–æ–º–µ–Ω.com/api/v1/webhooks" `
    -Method Post `
    -Headers $headers `
    -Body $body
```

**–ó–∞–º–µ–Ω–∏:**
- `fpa_live_—Ç–≤–æ–π_api_–∫–ª—é—á` ‚Üí —Ç–≤–æ–π API –∫–ª—é—á –∏–∑ Finappka
- `https://—Ç–≤–æ–π-workspace.app.n8n.cloud/webhook/finappka-webhook` ‚Üí URL –∏–∑ —à–∞–≥–∞ 1.2
- `aB3dE7fG9hJ2kL4mN6pQ8rS1tU5vW0xY` ‚Üí —Å–µ–∫—Ä–µ—Ç –∏–∑ —à–∞–≥–∞ 2.1
- `https://—Ç–≤–æ–π-–¥–æ–º–µ–Ω.com` ‚Üí URL —Ç–≤–æ–µ–≥–æ Finappka (ngrok –∏–ª–∏ production)

### 3.2. –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "webhook": {
    "id": "abc-123-def-456",
    "url": "https://...",
    "events": ["transaction.created"],
    "is_active": true,
    "created_at": "2024-10-23T21:00:00Z"
  }
}
```

**‚úÖ Webhook –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!**

---

## ‚ñ∂Ô∏è –®–∞–≥ 4: –ê–∫—Ç–∏–≤–∏—Ä—É–π Workflow

### 4.1. –í n8n Cloud

1. **–û—Ç–∫—Ä–æ–π workflow**

2. **–í–∫–ª—é—á–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "Active"** (–≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞)

3. **–°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å:** üü¢ Active

**‚úÖ Workflow –∞–∫—Ç–∏–≤–µ–Ω –∏ –∂–¥—ë—Ç —Å–æ–±—ã—Ç–∏—è!**

---

## üß™ –®–∞–≥ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π!

### 5.1. –°–æ–∑–¥–∞–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é

1. **–û—Ç–∫—Ä–æ–π Finappka**

2. **–°–æ–∑–¥–∞–π –Ω–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é:**
   - –°—É–º–º–∞: 500‚ÇΩ
   - –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü—Ä–æ–¥—É–∫—Ç—ã
   - –ó–∞–º–µ—Ç–∫–∞: –¢–µ—Å—Ç webhook

3. **–°–æ—Ö—Ä–∞–Ω–∏**

### 5.2. –ü—Ä–æ–≤–µ—Ä—å Telegram

**–ß–µ—Ä–µ–∑ 1-2 —Å–µ–∫—É–Ω–¥—ã –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏:**

```
üí∏ –ù–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è!

üíµ –°—É–º–º–∞: 500‚ÇΩ
üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü—Ä–æ–¥—É–∫—Ç—ã
üí≥ –°—á—ë—Ç: –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–∞
üìù –ó–∞–º–µ—Ç–∫–∞: –¢–µ—Å—Ç webhook
üìÖ –î–∞—Ç–∞: 23.10.2024 21:30

üîî –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Webhook
```

### 5.3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –≤ n8n

1. **Executions** (–≤ n8n Cloud)

2. **–î–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–æ–≤—ã–π execution:**
   - Status: ‚úÖ Success
   - Duration: ~1-2 —Å–µ–∫

**üéâ –†–ê–ë–û–¢–ê–ï–¢!**

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ webhook –≤ Finappka

**–ü–æ–ª—É—á–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:**

```powershell
$headers = @{
    "Authorization" = "Bearer fpa_live_—Ç–≤–æ–π_–∫–ª—é—á"
}

Invoke-RestMethod -Uri "https://—Ç–≤–æ–π-–¥–æ–º–µ–Ω.com/api/v1/webhooks" `
    -Method Get `
    -Headers $headers
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "webhooks": [
    {
      "id": "abc-123",
      "url": "https://...",
      "events": ["transaction.created"],
      "is_active": true,
      "total_calls": 15,
      "failed_calls": 0,
      "last_triggered_at": "2024-10-23T21:30:00Z",
      "last_success_at": "2024-10-23T21:30:00Z"
    }
  ]
}
```

---

## ‚öôÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π

```powershell
$body = @{
    url = "https://..."
    events = @(
        "transaction.created",
        "transaction.updated",
        "budget.exceeded"
    )
    secret = "..."
    name = "–í—Å–µ —Å–æ–±—ã—Ç–∏—è"
} | ConvertTo-Json
```

### –û—Ç–∫–ª—é—á–∏—Ç—å webhook

```powershell
Invoke-RestMethod -Uri "https://—Ç–≤–æ–π-–¥–æ–º–µ–Ω.com/api/v1/webhooks/abc-123" `
    -Method Put `
    -Headers $headers `
    -Body '{"is_active": false}' `
    -ContentType "application/json"
```

### –£–¥–∞–ª–∏—Ç—å webhook

```powershell
Invoke-RestMethod -Uri "https://—Ç–≤–æ–π-–¥–æ–º–µ–Ω.com/api/v1/webhooks/abc-123" `
    -Method Delete `
    -Headers $headers
```

---

## ‚ùì –ü—Ä–æ–±–ª–µ–º—ã?

### Webhook –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä—å:**

1. ‚úÖ Workflow –∞–∫—Ç–∏–≤–µ–Ω (–∑–µ–ª—ë–Ω—ã–π —Å—Ç–∞—Ç—É—Å)
2. ‚úÖ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (–±–µ–∑ –æ–ø–µ—á–∞—Ç–æ–∫)
3. ‚úÖ –°–µ–∫—Ä–µ—Ç —Å–æ–≤–ø–∞–¥–∞–µ—Ç –≤ n8n –∏ Finappka
4. ‚úÖ –°–æ–±—ã—Ç–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ (`transaction.created`)

### –û—à–∏–±–∫–∞ "Invalid signature"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–µ–∫—Ä–µ—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å `FINAPPKA_WEBHOOK_SECRET` –≤ n8n
2. –ü—Ä–æ–≤–µ—Ä—å `secret` –≤ webhook
3. –û–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –û–î–ò–ù–ê–ö–û–í–´–ú–ò

### Telegram –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å:**
1. Telegram credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
2. `TELEGRAM_CHAT_ID` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. –ë–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–∞—Ç
4. –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –≤ Executions

---

## üéì –ò—Ç–æ–≥–æ

### –ß—Ç–æ —Ç—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª:

‚úÖ **Webhook –≤ n8n Cloud** - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è  
‚úÖ **HMAC –ø–æ–¥–ø–∏—Å—å** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  
‚úÖ **Webhook –≤ Finappka** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è  
‚úÖ **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è  

### –ß—Ç–æ –ø–æ–ª—É—á–∞–µ—à—å:

‚ö° **–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** (1-2 —Å–µ–∫—É–Ω–¥—ã)  
üéØ **–¢–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è**  
üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** (HMAC –ø–æ–¥–ø–∏—Å—å)  
üí™ **–ù–∞–¥—ë–∂–Ω–æ** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ retry)  

---

## üìö –î–∞–ª—å—à–µ —á–∏—Ç–∞–π:

- üìñ [WEBHOOKS.md](./WEBHOOKS.md) - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- üöÄ [GETTING-STARTED.md](./GETTING-STARTED.md) - –æ–±—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ n8n
- üìä [README.md](./README.md) - –æ–±–∑–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

---

**–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢–µ–ø–µ—Ä—å —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è! üéâ**

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 23 –æ–∫—Ç—è–±—Ä—è 2024*

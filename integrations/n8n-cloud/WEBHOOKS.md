# üîî Webhooks: –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ü–æ–ª—É—á–∞–π —Å–æ–±—ã—Ç–∏—è –∏–∑ Finappka –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏!**

---

## üéØ –ß—Ç–æ —Ç–∞–∫–æ–µ Webhooks?

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã n8n –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç —Å–ø—Ä–∞—à–∏–≤–∞–ª "–ï—Å—Ç—å —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ?", Finappka **—Å–∞–º —Å—Ä–∞–∑—É —Å–æ–æ–±—â–∞–µ—Ç** n8n –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

### **–ê–Ω–∞–ª–æ–≥–∏—è:**

**–ë–ï–ó Webhooks (Polling):**
```
n8n: "–ï—Å—Ç—å –Ω–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏?" (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
Finappka: "–ù–µ—Ç"
n8n: "–ï—Å—Ç—å –Ω–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏?"
Finappka: "–ù–µ—Ç"
n8n: "–ï—Å—Ç—å –Ω–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏?"
Finappka: "–î–∞, –≤–æ—Ç –æ–¥–Ω–∞"
```
‚ö†Ô∏è –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ 5 –º–∏–Ω—É—Ç

**–° Webhooks:**
```
[–¢—ã —Å–æ–∑–¥–∞—ë—à—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é]
Finappka ‚Üí –°–†–ê–ó–£ ‚Üí n8n: "–ù–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è!"
n8n ‚Üí –ú–ì–ù–û–í–ï–ù–ù–û ‚Üí Telegram: "üí∏ –¢—Ä–∞—Ç–∞ 500‚ÇΩ"
```
‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ (1-2 —Å–µ–∫—É–Ω–¥—ã)

---

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### **–°—Ö–µ–º–∞:**

```
1. –¢–´ —Å–æ–∑–¥–∞—ë—à—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ Finappka
   ‚Üì
2. Finappka –°–†–ê–ó–£ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP POST –∑–∞–ø—Ä–æ—Å –≤ n8n
   ‚Üì
3. n8n –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
   ‚Üì
4. n8n –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
   ‚Üì
5. –¢–´ –ø–æ–ª—É—á–∞–µ—à—å —Å–æ–æ–±—â–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ 1-2 —Å–µ–∫—É–Ω–¥—ã!)
```

---

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–ø–æ—à–∞–≥–æ–≤–æ)

### **–®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π Webhook Workflow –≤ n8n**

1. **–°–∫–∞—á–∞–π —Ñ–∞–π–ª:**
   ```
   /workflows/webhook-telegram-instant.json
   ```

2. **–í n8n Cloud:**
   - Workflows ‚Üí Import from File
   - –í—ã–±–µ—Ä–∏ `webhook-telegram-instant.json`

3. **–ê–∫—Ç–∏–≤–∏—Ä—É–π workflow:**
   - –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "Active" ‚Üí ON

4. **–°–∫–æ–ø–∏—Ä—É–π Webhook URL:**
   ```
   https://—Ç–≤–æ–π-workspace.app.n8n.cloud/webhook/finappka-webhook
   ```

### **–®–∞–≥ 2: –°–æ–∑–¥–∞–π —Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏**

**–ó–∞—á–µ–º?** –ß—Ç–æ–±—ã –Ω–∏–∫—Ç–æ –∫—Ä–æ–º–µ Finappka –Ω–µ –º–æ–≥ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–µ–π–∫–æ–≤—ã–µ webhooks.

1. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É:**
   ```bash
   # –í PowerShell:
   -join ((48..57) + (65..90) + (97..122) | Get-Random -Count 32 | % {[char]$_})
   
   # –ò–ª–∏ –æ–Ω–ª–∞–π–Ω:
   https://www.random.org/strings/
   ```

2. **–°–æ—Ö—Ä–∞–Ω–∏ —Å–µ–∫—Ä–µ—Ç –≤ n8n:**
   ```
   Settings ‚Üí Environments
   Name: FINAPPKA_WEBHOOK_SECRET
   Value: —Ç–≤–æ–π-—Å–ª—É—á–∞–π–Ω—ã–π-—Å–µ–∫—Ä–µ—Ç-32-—Å–∏–º–≤–æ–ª–∞
   ```

### **–®–∞–≥ 3: –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π Webhook –≤ Finappka**

**–ß–µ—Ä–µ–∑ API:**

```bash
curl -X POST https://—Ç–≤–æ–π-–¥–æ–º–µ–Ω.com/api/v1/webhooks \
  -H "Authorization: Bearer fpa_live_—Ç–≤–æ–π_–∫–ª—é—á" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://—Ç–≤–æ–π-workspace.app.n8n.cloud/webhook/finappka-webhook",
    "events": ["transaction.created"],
    "secret": "—Ç–≤–æ–π-—Å–ª—É—á–∞–π–Ω—ã–π-—Å–µ–∫—Ä–µ—Ç-32-—Å–∏–º–≤–æ–ª–∞",
    "name": "n8n Telegram Notifications",
    "description": "–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "webhook": {
    "id": "abc-123-def-456",
    "url": "https://...",
    "events": ["transaction.created"],
    "is_active": true,
    "created_at": "2024-10-23T21:00:00Z"
  }
}
```

**‚úÖ –ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ Finappka –±—É–¥–µ—Ç –°–†–ê–ó–£ —É–≤–µ–¥–æ–º–ª—è—Ç—å n8n!

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: HMAC –ø–æ–¥–ø–∏—Å—å

### **–ö–∞–∫ Finappka –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç webhook:**

```javascript
// 1. –ë–µ—Ä—ë—Ç –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
const payload = JSON.stringify({
  event: "transaction.created",
  data: { ... },
  user_id: "...",
  occurred_at: "2024-10-23T21:00:00Z"
});

// 2. –í—ã—á–∏—Å–ª—è–µ—Ç HMAC SHA-256 –ø–æ–¥–ø–∏—Å—å
const signature = crypto
  .createHmac('sha256', '—Ç–≤–æ–π-—Å–µ–∫—Ä–µ—Ç')
  .update(payload)
  .digest('hex');

// 3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å —Å –ø–æ–¥–ø–∏—Å—å—é
POST https://n8n.cloud/webhook/finappka-webhook
Headers:
  X-Webhook-Signature: abc123def456...
  X-Webhook-Event: transaction.created
  X-Webhook-Timestamp: 2024-10-23T21:00:00Z
Body:
  { event: "...", data: { ... } }
```

### **–ö–∞–∫ n8n –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å:**

```javascript
// 1. –ü–æ–ª—É—á–∞–µ—Ç payload –∏ –ø–æ–¥–ø–∏—Å—å
const payload = JSON.stringify($json);
const receivedSignature = $headers['x-webhook-signature'];
const secret = $env.FINAPPKA_WEBHOOK_SECRET;

// 2. –í—ã—á–∏—Å–ª—è–µ—Ç –æ–∂–∏–¥–∞–µ–º—É—é –ø–æ–¥–ø–∏—Å—å
const expectedSignature = crypto
  .createHmac('sha256', secret)
  .update(payload)
  .digest('hex');

// 3. –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç
if (receivedSignature !== expectedSignature) {
  throw new Error('Invalid signature! –§–µ–π–∫–æ–≤—ã–π webhook!');
}

// 4. –ï—Å–ª–∏ —Å–æ–≤–ø–∞–ª–æ - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–æ–ª—å–∫–æ Finappka (–∑–Ω–∞—é—â–∏–π —Å–µ–∫—Ä–µ—Ç) –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∞–ª–∏–¥–Ω—ã–µ webhooks!

---

## üì° –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

### **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:**

| –°–æ–±—ã—Ç–∏–µ | –ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç | –î–∞–Ω–Ω—ã–µ |
|---------|-------------------|--------|
| `transaction.created` | –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è | –ü–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ |
| `transaction.updated` | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞ | –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç |
| `transaction.deleted` | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞ | `{ id: "..." }` |

### **–ë—é–¥–∂–µ—Ç—ã:**

| –°–æ–±—ã—Ç–∏–µ | –ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç | –î–∞–Ω–Ω—ã–µ |
|---------|-------------------|--------|
| `budget.exceeded` | –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –±—é–¥–∂–µ—Ç–∞ | –û–±—ä–µ–∫—Ç –±—é–¥–∂–µ—Ç–∞ + –ø—Ä–æ—Ü–µ–Ω—Ç |
| `budget.warning` | –ü–æ—Ç—Ä–∞—á–µ–Ω–æ 80% –±—é–¥–∂–µ—Ç–∞ | –û–±—ä–µ–∫—Ç –±—é–¥–∂–µ—Ç–∞ + –ø—Ä–æ—Ü–µ–Ω—Ç |

### **–¶–µ–ª–∏:**

| –°–æ–±—ã—Ç–∏–µ | –ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç | –î–∞–Ω–Ω—ã–µ |
|---------|-------------------|--------|
| `goal.achieved` | –î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —Ü–µ–ª—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è | –û–±—ä–µ–∫—Ç —Ü–µ–ª–∏ |
| `achievement.unlocked` | –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ | –û–±—ä–µ–∫—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è |

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### **–ü—Ä–∏–º–µ—Ä 1: Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**

**Workflow:**
```
Webhook ‚Üí Validate ‚Üí Format ‚Üí Telegram
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üí∏ –ù–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è!
üíµ –°—É–º–º–∞: 500‚ÇΩ
üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü—Ä–æ–¥—É–∫—Ç—ã
üí≥ –°—á—ë—Ç: –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–∞
üìù –ó–∞–º–µ—Ç–∫–∞: –ú–∞–≥–∞–∑–∏–Ω
üìÖ –î–∞—Ç–∞: 23.10.2024 21:30

üîî –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Webhook
```

### **–ü—Ä–∏–º–µ—Ä 2: Slack —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**

**Workflow:**
```
Webhook ‚Üí Validate ‚Üí Slack Message
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
:money_with_wings: New expense: $5.00
Category: Groceries
Account: Main Card
```

### **–ü—Ä–∏–º–µ—Ä 3: Google Sheets –∞–≤—Ç–æ–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ**

**Workflow:**
```
Webhook ‚Üí Validate ‚Üí Add Row to Google Sheets
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É.

### **–ü—Ä–∏–º–µ—Ä 4: Email –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö —Ç—Ä–∞—Ç–∞—Ö**

**Workflow:**
```
Webhook ‚Üí Validate ‚Üí IF amount > 10000 ‚Üí Send Email
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Email —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç—Ä–∞—Ç–∞ –±–æ–ª—å—à–µ 100‚ÇΩ.

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Webhooks

### **–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ webhooks:**

```bash
GET /api/v1/webhooks
Authorization: Bearer fpa_live_—Ç–≤–æ–π_–∫–ª—é—á
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "webhooks": [
    {
      "id": "abc-123",
      "url": "https://...",
      "events": ["transaction.created"],
      "is_active": true,
      "total_calls": 42,
      "failed_calls": 0,
      "last_triggered_at": "2024-10-23T21:30:00Z"
    }
  ]
}
```

### **–ü–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω webhook:**

```bash
GET /api/v1/webhooks/{id}
Authorization: Bearer fpa_live_—Ç–≤–æ–π_–∫–ª—é—á
```

### **–û–±–Ω–æ–≤–∏—Ç—å webhook:**

```bash
PUT /api/v1/webhooks/{id}
Authorization: Bearer fpa_live_—Ç–≤–æ–π_–∫–ª—é—á
Content-Type: application/json

{
  "is_active": false,
  "events": ["transaction.created", "transaction.updated"]
}
```

### **–£–¥–∞–ª–∏—Ç—å webhook:**

```bash
DELETE /api/v1/webhooks/{id}
Authorization: Bearer fpa_live_—Ç–≤–æ–π_–∫–ª—é—á
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ webhook:**

–ö–∞–∂–¥—ã–π webhook —Ö—Ä–∞–Ω–∏—Ç:
- `total_calls` - –≤—Å–µ–≥–æ –≤—ã–∑–æ–≤–æ–≤
- `failed_calls` - –Ω–µ—É–¥–∞—á–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
- `last_triggered_at` - –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–∑–æ–≤
- `last_success_at` - –ø–æ—Å–ª–µ–¥–Ω–∏–π —É—Å–ø–µ—à–Ω—ã–π
- `last_error_at` - –ø–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞
- `last_error_message` - —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏

### **–õ–æ–≥–∏ –≤ n8n:**

1. **Executions** ‚Üí –°–º–æ—Ç—Ä–∏ –≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
2. **–§–∏–ª—å—Ç—Ä—É–π –ø–æ workflow**
3. **–°–º–æ—Ç—Ä–∏ –¥–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ execution**

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook:**

```bash
# –û—Ç–ø—Ä–∞–≤—å —Ç–µ—Å—Ç–æ–≤—ã–π webhook –≤—Ä—É—á–Ω—É—é
curl -X POST https://—Ç–≤–æ–π-workspace.app.n8n.cloud/webhook/finappka-webhook \
  -H "Content-Type: application/json" \
  -H "X-Webhook-Signature: test" \
  -H "X-Webhook-Event: transaction.created" \
  -d '{
    "event": "transaction.created",
    "data": {
      "id": "test-123",
      "amount": 50000,
      "direction": "expense",
      "note": "Test transaction"
    },
    "user_id": "test-user",
    "occurred_at": "2024-10-23T21:00:00Z"
  }'
```

---

## ‚ö†Ô∏è Troubleshooting

### **Webhook –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**

1. **–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ workflow –∞–∫—Ç–∏–≤–µ–Ω:**
   - –í n8n Cloud –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–µ–ª—ë–Ω—ã–π —Å—Ç–∞—Ç—É—Å "Active"

2. **–ü—Ä–æ–≤–µ—Ä—å URL:**
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ n8n
   - –ë–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–ª–µ—à–µ–π

3. **–ü—Ä–æ–≤–µ—Ä—å —Å–µ–∫—Ä–µ—Ç:**
   - –î–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å –≤ Finappka –∏ n8n
   - –ë–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤

4. **–ü—Ä–æ–≤–µ—Ä—å —Å–æ–±—ã—Ç–∏—è:**
   - `events` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω—É–∂–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
   - –ù–∞–ø—Ä–∏–º–µ—Ä: `["transaction.created"]`

### **–û—à–∏–±–∫–∞ "Invalid signature":**

- –°–µ–∫—Ä–µ—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å `FINAPPKA_WEBHOOK_SECRET` –≤ n8n
- –ü—Ä–æ–≤–µ—Ä—å `secret` –≤ webhook

### **Webhook –ø–æ–ª—É—á–µ–Ω, –Ω–æ Telegram –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è:**

- –ü—Ä–æ–≤–µ—Ä—å Telegram credentials –≤ n8n
- –ü—Ä–æ–≤–µ—Ä—å `TELEGRAM_CHAT_ID`
- –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ execution –≤ n8n

### **–ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –¥–æ—Å—Ç–∞–≤–∫–µ:**

- Webhooks –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º–∏ (1-2 —Å–µ–∫)
- –ï—Å–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∞ - –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Finappka
- –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ç—å—é

---

## üÜö Webhooks vs Polling

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Webhooks | Polling (Schedule) |
|----------|----------|-------------------|
| **–°–∫–æ—Ä–æ—Å—Ç—å** | ‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ (1-2 —Å–µ–∫) | ‚è∞ –î–æ 5 –º–∏–Ω—É—Ç |
| **–ù–∞–≥—Ä—É–∑–∫–∞** | ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è | ‚ö†Ô∏è –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã |
| **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ç–∏ | ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ |
| **–ù–∞—Å—Ç—Ä–æ–π–∫–∞** | üîß –°–ª–æ–∂–Ω–µ–µ | ‚úÖ –ü—Ä–æ—â–µ |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | üîê HMAC –ø–æ–¥–ø–∏—Å—å | ‚úÖ API –∫–ª—é—á |
| **–î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤** | ‚ö†Ô∏è –°—Ä–µ–¥–Ω–µ | ‚úÖ –õ–µ–≥–∫–æ |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- **–î–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** ‚Üí Webhooks
- **–î–ª—è –æ—Ç—á—ë—Ç–æ–≤/–∞–Ω–∞–ª–∏—Ç–∏–∫–∏** ‚Üí Polling

---

## üí° Best Practices

### **1. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π –ø–æ–¥–ø–∏—Å—å:**

```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
const signature = $headers['x-webhook-signature'];
if (signature !== expectedSignature) {
  throw new Error('Invalid signature');
}

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏
```

### **2. –ò—Å–ø–æ–ª—å–∑—É–π retry –º–µ—Ö–∞–Ω–∏–∑–º:**

Finappka –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–µ—Ç 3 –ø–æ–ø—ã—Ç–∫–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π:
- –ü–æ–ø—ã—Ç–∫–∞ 1: —Å—Ä–∞–∑—É
- –ü–æ–ø—ã—Ç–∫–∞ 2: —á–µ—Ä–µ–∑ 2 —Å–µ–∫
- –ü–æ–ø—ã—Ç–∫–∞ 3: —á–µ—Ä–µ–∑ 4 —Å–µ–∫

### **3. –û—Ç–≤–µ—á–∞–π –±—ã—Å—Ç—Ä–æ:**

```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
Webhook ‚Üí Validate ‚Üí Respond (200 OK) ‚Üí Process async

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
Webhook ‚Üí Long processing ‚Üí Respond (timeout!)
```

### **4. –õ–æ–≥–∏—Ä—É–π –≤—Å—ë:**

- –í—Å–µ webhooks –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `webhook_logs`
- –ú–æ–∂–µ—à—å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤ Finappka

### **5. –û—Ç–∫–ª—é—á–∞–π –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ:**

```bash
# –ï—Å–ª–∏ webhook –Ω–µ –Ω—É–∂–µ–Ω - –æ—Ç–∫–ª—é—á–∏
PUT /api/v1/webhooks/{id}
{ "is_active": false }
```

---

## üéì –ò—Ç–æ–≥–æ

### **–ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å:**

‚úÖ **–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** (1-2 —Å–µ–∫—É–Ω–¥—ã)  
‚úÖ **–ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏** –Ω–∞ API  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** —á–µ—Ä–µ–∑ HMAC –ø–æ–¥–ø–∏—Å—å  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω—É–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è  
‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ retry  

### **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π `webhook-telegram-instant.json`
2. –°–æ–∑–¥–∞–π —Å–µ–∫—Ä–µ—Ç
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π webhook –≤ Finappka
4. –°–æ–∑–¥–∞–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
5. –ü–æ–ª—É—á–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ! üéâ

---

**Happy webhooking! üöÄ**

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 23 –æ–∫—Ç—è–±—Ä—è 2024*
